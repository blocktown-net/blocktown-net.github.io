(self.AMP=self.AMP||[]).push({n:"amp-share-tracking",v:"1910151804560",f:(function(AMP,_){
var h="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},k;if("function"==typeof Object.setPrototypeOf)k=Object.setPrototypeOf;else{var l;a:{var m={a:!0},n={};try{n.__proto__=m;l=n.a;break a}catch(a){}l=!1}k=l?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var p=k;function q(a,b){b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(c){return b}};var t=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var u=self.__AMP_LOG;function v(){if(!u.user)throw Error("failed to call initLogConstructor");return u.user};function w(a){return new Promise(function(b){b(a())})};function x(a){var b="amp-share-tracking";if(a.__AMP__EXPERIMENT_TOGGLES)var c=a.__AMP__EXPERIMENT_TOGGLES;else{a.__AMP__EXPERIMENT_TOGGLES=Object.create(null);c=a.__AMP__EXPERIMENT_TOGGLES;if(a.AMP_CONFIG)for(var d in a.AMP_CONFIG){var e=a.AMP_CONFIG[d];"number"===typeof e&&0<=e&&1>=e&&(c[d]=Math.random()<e)}if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-doc-opt-in"])&&0<a.AMP_CONFIG["allow-doc-opt-in"].length&&(d=a.AMP_CONFIG["allow-doc-opt-in"],e=a.document.head.querySelector('meta[name="amp-experiments-opt-in"]'))){e=
e.getAttribute("content").split(",");for(var g=0;g<e.length;g++)-1!=d.indexOf(e[g])&&(c[e[g]]=!0)}Object.assign(c,y(a));if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-url-opt-in"])&&0<a.AMP_CONFIG["allow-url-opt-in"].length){d=a.AMP_CONFIG["allow-url-opt-in"];e=a.location.originalHash||a.location.hash;a=Object.create(null);if(e)for(var f;f=t.exec(e);)g=q(f[1],f[1]),f=f[2]?q(f[2].replace(/\+/g," "),f[2]):"",a[g]=f;for(e=0;e<d.length;e++)g=a["e-"+d[e]],"1"==g&&(c[d[e]]=!0),"0"==g&&(c[d[e]]=!1)}}var r=
c;return!!r[b]}function y(a){var b="";try{"localStorage"in a&&(b=a.localStorage.getItem("amp-experiment-toggles"))}catch(e){if(u.dev)a=u.dev;else throw Error("failed to call initLogConstructor");a.warn("EXPERIMENTS","Failed to retrieve experiments from localStorage.")}var c=b?b.split(/\s*,\s*/g):[];a=Object.create(null);for(var d=0;d<c.length;d++)0!=c[d].length&&("-"==c[d][0]?a[c[d].substr(1)]=!1:a[c[d]]=!0);return a};function z(a,b){var c,d=a=a.__AMP_TOP||(a.__AMP_TOP=a),e=a,g=A(d),f=g["share-tracking"];f||(f=g["share-tracking"]={obj:null,promise:null,resolve:null,reject:null,context:null,ctor:null});f.ctor||f.obj||(f.ctor=b,f.context=e,f.resolve&&B(d,"share-tracking"));c&&B(a,"share-tracking")}function C(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return B(a,b)}function D(a){var b=E(a);b=E(b);b=b.isSingleDoc()?b.win:b;return B(b,"history")}
function E(a){return a.nodeType?C((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function B(a,b){var c=A(a);a=c[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function A(a){var b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function F(a){for(var b=Array(a.length),c=0;c<a.length;c++)b[c]=String.fromCharCode(a[c]);return b.join("")};var G={"+":"-","/":"_","=":"."};function H(a){a=F(a);return btoa(a).replace(/[+/=]/g,function(a){return G[a]})};function I(a){a=AMP.BaseElement.call(this,a)||this;a.h="";a.c="";return a}var J=AMP.BaseElement;I.prototype=h(J.prototype);I.prototype.constructor=I;if(p)p(I,J);else for(var K in J)if("prototype"!=K)if(Object.defineProperties){var L=Object.getOwnPropertyDescriptor(J,K);L&&Object.defineProperty(I,K,L)}else I[K]=J[K];I.j=J.prototype;I.prototype.isLayoutSupported=function(a){return"nodisplay"==a||"container"==a};
I.prototype.buildCallback=function(){var a=this;x(this.win)||(z(this.win,function(){return Promise.reject(v().createError("%s disabled","amp-share-tracking"))}),v().assert(!1,"%s experiment is disabled","amp-share-tracking",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0));this.h=this.element.getAttribute("data-href");var b=Promise.all([M(this),N(this)]).then(function(b){var d=b[0],c=b[1];if(c&&""!=c){var g=d;g=g?a.c.substr(g.length+1):a.c;var f="."+c;g&&("&"!=g[0]&&(f+="&"),f+=g);var r=f;
D(a.getAmpDoc()).updateFragment(r)}return{incomingFragment:d,outgoingFragment:c}});z(this.win,function(){return b})};function M(a){return O(a).then(function(a){return(a=a.match(/^\.([^&]*)/))?a[1]:""})}function O(a){return D(a.getAmpDoc()).getFragment().then(function(b){return a.c=b})}
function N(a){return a.h?P(a,a.h):w(function(){var b=a.win;if(b.crypto&&b.crypto.getRandomValues){var c=new Uint8Array(6);b.crypto.getRandomValues(c);b=c}else b=null;if(!b){b=new Uint8Array(6);c=Math.random();for(var d=0;6>d;d++)c*=256,b[d]=Math.floor(c),c-=b[d]}return H(b)})}
function P(a,b){var c={method:"POST",credentials:"include",body:{}};return C(a.win,"xhr").fetchJson(b,c).then(function(a){return a.json()}).then(function(c){if(c.fragment)return c.fragment;a.user().error("amp-share-tracking","The response from ["+b+"] does not have a fragment value.");return""},function(b){a.user().error("amp-share-tracking","The request to share-tracking endpoint failed:",b);return""})}(function(a){a.registerElement("amp-share-tracking",I)})(self.AMP);
})});

//# sourceMappingURL=amp-share-tracking-0.1.js.map
