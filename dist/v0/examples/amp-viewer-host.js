(function(){var optsSupported$$module$src$event_helper_listen;
function internalListenImplementation$$module$src$event_helper_listen(element,eventType,listener,opt_evtListenerOpts){var localElement=element;var localListener=listener;var wrapped;wrapped=function(event){try{return localListener(event)}catch(e){self.__AMP_REPORT_ERROR(e);throw e;}};var optsSupported=detectEvtListenerOptsSupport$$module$src$event_helper_listen();var capture=false;if(opt_evtListenerOpts)capture=opt_evtListenerOpts.capture;localElement.addEventListener(eventType,wrapped,optsSupported?
opt_evtListenerOpts:capture);return function(){if(localElement)localElement.removeEventListener(eventType,wrapped,optsSupported?opt_evtListenerOpts:capture);localListener=null;localElement=null;wrapped=null}}
function detectEvtListenerOptsSupport$$module$src$event_helper_listen(){if(optsSupported$$module$src$event_helper_listen!==undefined)return optsSupported$$module$src$event_helper_listen;optsSupported$$module$src$event_helper_listen=false;try{var options={get capture(){optsSupported$$module$src$event_helper_listen=true}};self.addEventListener("test-options",null,options);self.removeEventListener("test-options",null,options)}catch(err){}return optsSupported$$module$src$event_helper_listen}
function resetEvtListenerOptsSupportForTesting$$module$src$event_helper_listen(){optsSupported$$module$src$event_helper_listen=undefined}var module$src$event_helper_listen={};module$src$event_helper_listen.detectEvtListenerOptsSupport=detectEvtListenerOptsSupport$$module$src$event_helper_listen;module$src$event_helper_listen.internalListenImplementation=internalListenImplementation$$module$src$event_helper_listen;module$src$event_helper_listen.resetEvtListenerOptsSupportForTesting=resetEvtListenerOptsSupportForTesting$$module$src$event_helper_listen;var Deferred$$module$src$utils$promise=function(){var resolve;var reject;this.promise=new Promise(function(res,rej){resolve=res;reject=rej});this.resolve=resolve;this.reject=reject};function tryResolve$$module$src$utils$promise(fn){return new Promise(function(resolve){resolve(fn())})}
function some$$module$src$utils$promise(promises,count){count=count===undefined?1:count;return new Promise(function(resolve,reject){count=Math.max(count,0);var extra=promises.length-count;if(extra<0)reject(new Error("not enough promises to resolve"));if(promises.length==0)resolve([]);var values=[];var reasons=[];var onFulfilled=function(value){if(values.length<count)values.push(value);if(values.length==count)resolve(values)};var onRejected=function(reason){if(reasons.length<=extra)reasons.push(reason);
if(reasons.length>extra)reject(reasons)};for(var i=0;i<promises.length;i++)Promise.resolve(promises[i]).then(onFulfilled,onRejected)})}var LastAddedResolver$$module$src$utils$promise=function(opt_promises){var resolve_;var reject_;this.promise_=new Promise(function(resolve,reject){resolve_=resolve;reject_=reject});this.resolve_=resolve_;this.reject_=reject_;this.count_=0;if(opt_promises)for(var i=0;i<opt_promises.length;i++)this.add(opt_promises[i])};
LastAddedResolver$$module$src$utils$promise.prototype.add=function(promise){var $jscomp$this=this;var countAtAdd=++this.count_;Promise.resolve(promise).then(function(result){if($jscomp$this.count_===countAtAdd)$jscomp$this.resolve_(result)},function(error){if($jscomp$this.count_===countAtAdd)$jscomp$this.reject_(error)});return this.promise_};LastAddedResolver$$module$src$utils$promise.prototype.then=function(opt_resolve,opt_reject){return this.promise_.then(opt_resolve,opt_reject)};
var module$src$utils$promise={};module$src$utils$promise.Deferred=Deferred$$module$src$utils$promise;module$src$utils$promise.LastAddedResolver=LastAddedResolver$$module$src$utils$promise;module$src$utils$promise.some=some$$module$src$utils$promise;module$src$utils$promise.tryResolve=tryResolve$$module$src$utils$promise;/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
var regex$$module$third_party$css_escape$css_escape=/(\0)|^(-)$|([\x01-\x1f\x7f]|^-?[0-9])|([\x80-\uffff0-9a-zA-Z_-]+)|[^]/g;function escaper$$module$third_party$css_escape$css_escape(match,nil,dash,hexEscape,chars){if(chars)return chars;if(nil)return"\ufffd";if(hexEscape)return match.slice(0,-1)+"\\"+match.slice(-1).charCodeAt(0).toString(16)+" ";return"\\"+match}
function cssEscape$$module$third_party$css_escape$css_escape(value){return String(value).replace(regex$$module$third_party$css_escape$css_escape,escaper$$module$third_party$css_escape$css_escape)}var module$third_party$css_escape$css_escape={};module$third_party$css_escape$css_escape.cssEscape=cssEscape$$module$third_party$css_escape$css_escape;function internalRuntimeVersion$$module$src$internal_version(){return"$internalRuntimeVersion$"}var module$src$internal_version={};module$src$internal_version.internalRuntimeVersion=internalRuntimeVersion$$module$src$internal_version;function tryDecodeUriComponent_$$module$src$url_try_decode_uri_component(component,fallback){fallback=fallback===undefined?"":fallback;try{return decodeURIComponent(component)}catch(e){return fallback}}var module$src$url_try_decode_uri_component={};module$src$url_try_decode_uri_component.tryDecodeUriComponent_=tryDecodeUriComponent_$$module$src$url_try_decode_uri_component;var regex$$module$src$url_parse_query_string=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;
function parseQueryString_$$module$src$url_parse_query_string(queryString){var params=Object.create(null);if(!queryString)return params;var match;while(match=regex$$module$src$url_parse_query_string.exec(queryString)){var name=tryDecodeUriComponent_$$module$src$url_try_decode_uri_component(match[1],match[1]);var value=match[2]?tryDecodeUriComponent_$$module$src$url_try_decode_uri_component(match[2].replace(/\+/g," "),match[2]):"";params[name]=value}return params}
var module$src$url_parse_query_string={};module$src$url_parse_query_string.parseQueryString_=parseQueryString_$$module$src$url_parse_query_string;var ModeDef$$module$src$mode;var rtvVersion$$module$src$mode="";function getMode$$module$src$mode(opt_win){var win=opt_win||self;if(win.__AMP_MODE)return win.__AMP_MODE;return win.__AMP_MODE=getMode_$$module$src$mode(win)}
function getMode_$$module$src$mode(win){var AMP_CONFIG=self.AMP_CONFIG||{};var IS_DEV=true;var IS_MINIFIED=true;var localDevEnabled=!!AMP_CONFIG.localDev;var runningTests=!!AMP_CONFIG.test||IS_DEV&&!!(win.__AMP_TEST||win.__karma__);var runningTestsOnIe=win.__karma__&&win.__karma__.config.amp.testOnIe;var isLocalDev=IS_DEV&&(localDevEnabled||runningTests);var hashQuery=parseQueryString_$$module$src$url_parse_query_string(win.location.originalHash||win.location.hash);var singlePassType=AMP_CONFIG.spt;
var searchQuery=parseQueryString_$$module$src$url_parse_query_string(win.location.search);if(!rtvVersion$$module$src$mode)rtvVersion$$module$src$mode=getRtvVersion$$module$src$mode(win,isLocalDev);return{localDev:isLocalDev,development:!!(["1","actions","amp","amp4ads","amp4email"].indexOf(hashQuery["development"])>=0||win.AMP_DEV_MODE),examiner:hashQuery["development"]=="2",filter:hashQuery["filter"],geoOverride:hashQuery["amp-geo"],userLocationOverride:hashQuery["amp-user-location"],minified:IS_MINIFIED,
lite:searchQuery["amp_lite"]!=undefined,test:runningTests,testIe:runningTestsOnIe,log:hashQuery["log"],version:"1910151804560",rtvVersion:rtvVersion$$module$src$mode,singlePassType:singlePassType}}function getRtvVersion$$module$src$mode(win,isLocalDev){if(isLocalDev)return"1910151804560";if(win.AMP_CONFIG&&win.AMP_CONFIG.v)return win.AMP_CONFIG.v;return"01"+"1910151804560"}function getRtvVersionForTesting$$module$src$mode(win,isLocalDev){return getRtvVersion$$module$src$mode(win,isLocalDev)}
function resetRtvVersionForTesting$$module$src$mode(){rtvVersion$$module$src$mode=""}var module$src$mode={};module$src$mode.ModeDef;module$src$mode.getMode=getMode$$module$src$mode;module$src$mode.getRtvVersionForTesting=getRtvVersionForTesting$$module$src$mode;module$src$mode.resetRtvVersionForTesting=resetRtvVersionForTesting$$module$src$mode;function getModeObject$$module$src$mode_object(opt_win){return{localDev:getMode$$module$src$mode(opt_win).localDev,development:getMode$$module$src$mode(opt_win).development,filter:getMode$$module$src$mode(opt_win).filter,minified:getMode$$module$src$mode(opt_win).minified,lite:getMode$$module$src$mode(opt_win).lite,test:getMode$$module$src$mode(opt_win).test,log:getMode$$module$src$mode(opt_win).log,version:getMode$$module$src$mode(opt_win).version,rtvVersion:getMode$$module$src$mode(opt_win).rtvVersion,
singlePassType:getMode$$module$src$mode(opt_win).singlePassType}}var module$src$mode_object={};module$src$mode_object.getModeObject=getModeObject$$module$src$mode_object;var toString_$$module$src$types=Object.prototype.toString;function toString$$module$src$types(value){return toString_$$module$src$types.call(value)}function isArray$$module$src$types(value){return Array.isArray(value)}function toArray$$module$src$types(arrayLike){return arrayLike?Array.prototype.slice.call(arrayLike):[]}function isObject$$module$src$types(value){return toString$$module$src$types(value)==="[object Object]"}
function isFiniteNumber$$module$src$types(value){return typeof value==="number"&&isFinite(value)}function isEnumValue$$module$src$types(enumObj,s){for(var k in enumObj)if(enumObj[k]===s)return true;return false}function toWin$$module$src$types(winOrNull){return winOrNull}var module$src$types={};module$src$types.isArray=isArray$$module$src$types;module$src$types.isEnumValue=isEnumValue$$module$src$types;module$src$types.isFiniteNumber=isFiniteNumber$$module$src$types;module$src$types.isObject=isObject$$module$src$types;
module$src$types.toArray=toArray$$module$src$types;module$src$types.toWin=toWin$$module$src$types;function once$$module$src$utils$function(fn){var evaluated=false;var retValue=null;var callback=fn;return function(args){var $jscomp$restParams=[];for(var $jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];{var args$0=$jscomp$restParams;if(!evaluated){retValue=callback.apply(self,args$0);evaluated=true;callback=null}return retValue}}}var module$src$utils$function={};module$src$utils$function.once=once$$module$src$utils$function;var env$$module$src$config=self.AMP_CONFIG||{};var thirdPartyFrameRegex$$module$src$config=typeof env$$module$src$config["thirdPartyFrameRegex"]=="string"?new RegExp(env$$module$src$config["thirdPartyFrameRegex"]):env$$module$src$config["thirdPartyFrameRegex"];var cdnProxyRegex$$module$src$config=typeof env$$module$src$config["cdnProxyRegex"]=="string"?new RegExp(env$$module$src$config["cdnProxyRegex"]):env$$module$src$config["cdnProxyRegex"];
var urls$$module$src$config={thirdParty:env$$module$src$config["thirdPartyUrl"]||"https://3p.ampproject.net",thirdPartyFrameHost:env$$module$src$config["thirdPartyFrameHost"]||"ampproject.net",thirdPartyFrameRegex:thirdPartyFrameRegex$$module$src$config||/^d-\d+\.ampproject\.net$/,cdn:env$$module$src$config["cdnUrl"]||"https://cdn.ampproject.org",cdnProxyRegex:cdnProxyRegex$$module$src$config||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,errorReporting:env$$module$src$config["errorReportingUrl"]||
"https://amp-error-reporting.appspot.com/r",localDev:env$$module$src$config["localDev"]||false,trustedViewerHosts:[/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,/(^|\.)gmail\.dev$/]};var config$$module$src$config={urls:urls$$module$src$config};var module$src$config={};module$src$config.config=config$$module$src$config;module$src$config.urls=urls$$module$src$config;var noop$$module$src$log=function(){};var USER_ERROR_SENTINEL$$module$src$log="\u200b\u200b\u200b";var USER_ERROR_EMBED_SENTINEL$$module$src$log="\u200b\u200b\u200b\u200b";function isUserErrorMessage$$module$src$log(message){return message.indexOf(USER_ERROR_SENTINEL$$module$src$log)>=0}function isUserErrorEmbed$$module$src$log(message){return message.indexOf(USER_ERROR_EMBED_SENTINEL$$module$src$log)>=0}var LogLevel$$module$src$log={OFF:0,ERROR:1,WARN:2,INFO:3,FINE:4};
function setReportError$$module$src$log(fn){self.__AMP_REPORT_ERROR=fn}var levelOverride_$$module$src$log=undefined;function overrideLogLevel$$module$src$log(level){levelOverride_$$module$src$log=level}var messageUrlRtv$$module$src$log=function(){return"01"+"1910151804560"};
var externalMessageUrl$$module$src$log=function(id,interpolatedParts){return interpolatedParts.reduce(function(prefix,arg){return prefix+"&s[]="+messageArgToEncodedComponent$$module$src$log(arg)},"https://log.amp.dev/?v="+messageUrlRtv$$module$src$log()+"&id="+encodeURIComponent(id))};var externalMessagesSimpleTableUrl$$module$src$log=function(){return urls$$module$src$config.cdn+"/rtv/"+messageUrlRtv$$module$src$log()+"/log-messages.simple.json"};
var messageArgToEncodedComponent$$module$src$log=function(arg){return encodeURIComponent(String(elementStringOrPassthru$$module$src$log(arg)))};
var Log$$module$src$log=function(win,levelFunc,opt_suffix){var $jscomp$this=this;opt_suffix=opt_suffix===undefined?"":opt_suffix;this.win=getMode$$module$src$mode().test&&win.__AMP_TEST_IFRAME?win.parent:win;this.levelFunc_=levelFunc;this.level_=this.defaultLevel_();this.suffix_=opt_suffix;this.messages_=null;this.fetchExternalMessagesOnce_=once$$module$src$utils$function(function(){win.fetch(externalMessagesSimpleTableUrl$$module$src$log()).then(function(response){return response.json()},noop$$module$src$log).then(function(opt_messages){if(opt_messages)$jscomp$this.messages_=
opt_messages})})};Log$$module$src$log.prototype.getLevel_=function(){return levelOverride_$$module$src$log!==undefined?levelOverride_$$module$src$log:this.level_};
Log$$module$src$log.prototype.defaultLevel_=function(){if(!this.win.console||!this.win.console.log)return LogLevel$$module$src$log.OFF;if(getMode$$module$src$mode().log=="0")return LogLevel$$module$src$log.OFF;if(getMode$$module$src$mode().test&&this.win.ENABLE_LOG)return LogLevel$$module$src$log.FINE;if(getMode$$module$src$mode().localDev&&!getMode$$module$src$mode().log)return LogLevel$$module$src$log.INFO;return this.levelFunc_(getModeObject$$module$src$mode_object())};
Log$$module$src$log.prototype.msg_=function(tag,level,messages){if(this.getLevel_()!=LogLevel$$module$src$log.OFF){var fn=this.win.console.log;if(level=="ERROR")fn=this.win.console.error||fn;else if(level=="INFO")fn=this.win.console.info||fn;else if(level=="WARN")fn=this.win.console.warn||fn;var args=this.maybeExpandMessageArgs_(messages);var prefix="["+tag+"]";if(typeof args[0]==="string")args[0]=prefix+" "+args[0];else args.unshift(prefix);fn.apply(this.win.console,args)}};
Log$$module$src$log.prototype.isEnabled=function(){return this.getLevel_()!=LogLevel$$module$src$log.OFF};Log$$module$src$log.prototype.fine=function(tag,var_args){if(this.getLevel_()>=LogLevel$$module$src$log.FINE)this.msg_(tag,"FINE",Array.prototype.slice.call(arguments,1))};Log$$module$src$log.prototype.info=function(tag,var_args){if(this.getLevel_()>=LogLevel$$module$src$log.INFO)this.msg_(tag,"INFO",Array.prototype.slice.call(arguments,1))};
Log$$module$src$log.prototype.warn=function(tag,var_args){if(this.getLevel_()>=LogLevel$$module$src$log.WARN)this.msg_(tag,"WARN",Array.prototype.slice.call(arguments,1))};Log$$module$src$log.prototype.error_=function(tag,var_args){if(this.getLevel_()>=LogLevel$$module$src$log.ERROR)this.msg_(tag,"ERROR",Array.prototype.slice.call(arguments,1));else{var error=createErrorVargs$$module$src$log.apply(null,Array.prototype.slice.call(arguments,1));this.prepareError_(error);return error}};
Log$$module$src$log.prototype.error=function(tag,var_args){var error=this.error_.apply(this,arguments);if(error){error.name=tag||error.name;self.__AMP_REPORT_ERROR(error)}};Log$$module$src$log.prototype.expectedError=function(unusedTag,var_args){var error=this.error_.apply(this,arguments);if(error){error.expected=true;self.__AMP_REPORT_ERROR(error)}};
Log$$module$src$log.prototype.createError=function(var_args){var error=createErrorVargs$$module$src$log.apply(null,arguments);this.prepareError_(error);return error};Log$$module$src$log.prototype.createExpectedError=function(var_args){var error=createErrorVargs$$module$src$log.apply(null,arguments);this.prepareError_(error);error.expected=true;return error};
Log$$module$src$log.prototype.assert=function(shouldBeTrueish,opt_message,var_args){var firstElement;if(isArray$$module$src$types(opt_message))return this.assert.apply(this,[shouldBeTrueish].concat(this.expandMessageArgs_(opt_message)));if(!shouldBeTrueish){var message=opt_message||"Assertion failed";var splitMessage=message.split("%s");var first=splitMessage.shift();var formatted=first;var messageArray=[];var i=2;pushIfNonEmpty$$module$src$log(messageArray,first);while(splitMessage.length>0){var nextConstant=
splitMessage.shift();var val=arguments[i++];if(val&&val.tagName)firstElement=val;messageArray.push(val);pushIfNonEmpty$$module$src$log(messageArray,nextConstant.trim());formatted+=stringOrElementString$$module$src$log(val)+nextConstant}var e=new Error(formatted);e.fromAssert=true;e.associatedElement=firstElement;e.messageArray=messageArray;this.prepareError_(e);self.__AMP_REPORT_ERROR(e);throw e;}return shouldBeTrueish};
Log$$module$src$log.prototype.assertElement=function(shouldBeElement,opt_message){var shouldBeTrueish=shouldBeElement&&shouldBeElement.nodeType==1;this.assertType_(shouldBeElement,shouldBeTrueish,"Element expected",opt_message);return shouldBeElement};Log$$module$src$log.prototype.assertString=function(shouldBeString,opt_message){this.assertType_(shouldBeString,typeof shouldBeString=="string","String expected",opt_message);return shouldBeString};
Log$$module$src$log.prototype.assertNumber=function(shouldBeNumber,opt_message){this.assertType_(shouldBeNumber,typeof shouldBeNumber=="number","Number expected",opt_message);return shouldBeNumber};Log$$module$src$log.prototype.assertArray=function(shouldBeArray,opt_message){this.assertType_(shouldBeArray,isArray$$module$src$types(shouldBeArray),"Array expected",opt_message);return shouldBeArray};
Log$$module$src$log.prototype.assertBoolean=function(shouldBeBoolean,opt_message){this.assertType_(shouldBeBoolean,!!shouldBeBoolean===shouldBeBoolean,"Boolean expected",opt_message);return shouldBeBoolean};Log$$module$src$log.prototype.assertEnumValue=function(enumObj,s,opt_enumName){if(isEnumValue$$module$src$types(enumObj,s))return s;this.assert(false,'Unknown %s value: "%s"',opt_enumName||"enum",s)};
Log$$module$src$log.prototype.prepareError_=function(error){error=duplicateErrorIfNecessary$$module$src$log(error);if(this.suffix_)if(!error.message)error.message=this.suffix_;else{if(error.message.indexOf(this.suffix_)==-1)error.message+=this.suffix_}else if(isUserErrorMessage$$module$src$log(error.message))error.message=error.message.replace(USER_ERROR_SENTINEL$$module$src$log,"")};
Log$$module$src$log.prototype.maybeExpandMessageArgs_=function(args){if(isArray$$module$src$types(args[0]))return this.expandMessageArgs_(args[0]);return args};Log$$module$src$log.prototype.expandMessageArgs_=function(parts){var id=parts.shift();if(getMode$$module$src$mode(this.win).development)this.fetchExternalMessagesOnce_();if(this.messages_&&id in this.messages_)return[this.messages_[id]].concat(parts);return["More info at "+externalMessageUrl$$module$src$log(id,parts)]};
Log$$module$src$log.prototype.assertType_=function(subject,assertion,defaultMessage,opt_message){if(isArray$$module$src$types(opt_message))this.assert(assertion,opt_message.concat(subject));else this.assert(assertion,(opt_message||defaultMessage)+": %s",subject)};var stringOrElementString$$module$src$log=function(val){return elementStringOrPassthru$$module$src$log(val)};
function elementStringOrPassthru$$module$src$log(val){if(val&&val.nodeType==1)return val.tagName.toLowerCase()+(val.id?"#"+val.id:"");return val}function pushIfNonEmpty$$module$src$log(array,val){if(val!="")array.push(val)}
function duplicateErrorIfNecessary$$module$src$log(error){var messageProperty=Object.getOwnPropertyDescriptor(error,"message");if(messageProperty&&messageProperty.writable)return error;var $jscomp$destructuring$var0=error;var message=$jscomp$destructuring$var0.message;var stack=$jscomp$destructuring$var0.stack;var e=new Error(message);for(var prop in error)e[prop]=error[prop];e.stack=stack;return e}
function createErrorVargs$$module$src$log(var_args){var error=null;var message="";for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(arg instanceof Error&&!error)error=duplicateErrorIfNecessary$$module$src$log(arg);else{if(message)message+=" ";message+=arg}}if(!error)error=new Error(message);else if(message)error.message=message+": "+error.message;return error}
function rethrowAsync$$module$src$log(var_args){var error=createErrorVargs$$module$src$log.apply(null,arguments);setTimeout(function(){self.__AMP_REPORT_ERROR(error);throw error;})}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var logs$$module$src$log=self.__AMP_LOG;var logConstructor$$module$src$log=null;function initLogConstructor$$module$src$log(){logConstructor$$module$src$log=Log$$module$src$log;dev$$module$src$log();user$$module$src$log()}
function resetLogConstructorForTesting$$module$src$log(){logConstructor$$module$src$log=null}
function user$$module$src$log(opt_element){if(!logs$$module$src$log.user)logs$$module$src$log.user=getUserLogger$$module$src$log(USER_ERROR_SENTINEL$$module$src$log);if(!isFromEmbed$$module$src$log(logs$$module$src$log.user.win,opt_element))return logs$$module$src$log.user;else{if(logs$$module$src$log.userForEmbed)return logs$$module$src$log.userForEmbed;return logs$$module$src$log.userForEmbed=getUserLogger$$module$src$log(USER_ERROR_EMBED_SENTINEL$$module$src$log)}}
function getUserLogger$$module$src$log(suffix){if(!logConstructor$$module$src$log)throw new Error("failed to call initLogConstructor");return new logConstructor$$module$src$log(self,function(mode){var logNum=parseInt(mode.log,10);if(mode.development||logNum>=1)return LogLevel$$module$src$log.FINE;return LogLevel$$module$src$log.WARN},suffix)}
function dev$$module$src$log(){if(logs$$module$src$log.dev)return logs$$module$src$log.dev;if(!logConstructor$$module$src$log)throw new Error("failed to call initLogConstructor");return logs$$module$src$log.dev=new logConstructor$$module$src$log(self,function(mode){var logNum=parseInt(mode.log,10);if(logNum>=3)return LogLevel$$module$src$log.FINE;if(logNum>=2)return LogLevel$$module$src$log.INFO;return LogLevel$$module$src$log.OFF})}
function isFromEmbed$$module$src$log(win,opt_element){if(!opt_element)return false;return opt_element.ownerDocument.defaultView!=win}function devAssert$$module$src$log(shouldBeTrueish,opt_message,opt_1,opt_2,opt_3,opt_4,opt_5,opt_6,opt_7,opt_8,opt_9){if(getMode$$module$src$mode().minified)return shouldBeTrueish;return dev$$module$src$log().assert(shouldBeTrueish,opt_message,opt_1,opt_2,opt_3,opt_4,opt_5,opt_6,opt_7,opt_8,opt_9)}
function userAssert$$module$src$log(shouldBeTrueish,opt_message,opt_1,opt_2,opt_3,opt_4,opt_5,opt_6,opt_7,opt_8,opt_9){return user$$module$src$log().assert(shouldBeTrueish,opt_message,opt_1,opt_2,opt_3,opt_4,opt_5,opt_6,opt_7,opt_8,opt_9)}var module$src$log={};module$src$log.Log=Log$$module$src$log;module$src$log.LogLevel=LogLevel$$module$src$log;module$src$log.USER_ERROR_EMBED_SENTINEL=USER_ERROR_EMBED_SENTINEL$$module$src$log;module$src$log.USER_ERROR_SENTINEL=USER_ERROR_SENTINEL$$module$src$log;
module$src$log.createErrorVargs=createErrorVargs$$module$src$log;module$src$log.dev=dev$$module$src$log;module$src$log.devAssert=devAssert$$module$src$log;module$src$log.duplicateErrorIfNecessary=duplicateErrorIfNecessary$$module$src$log;module$src$log.initLogConstructor=initLogConstructor$$module$src$log;module$src$log.isFromEmbed=isFromEmbed$$module$src$log;module$src$log.isUserErrorEmbed=isUserErrorEmbed$$module$src$log;module$src$log.isUserErrorMessage=isUserErrorMessage$$module$src$log;
module$src$log.overrideLogLevel=overrideLogLevel$$module$src$log;module$src$log.resetLogConstructorForTesting=resetLogConstructorForTesting$$module$src$log;module$src$log.rethrowAsync=rethrowAsync$$module$src$log;module$src$log.setReportError=setReportError$$module$src$log;module$src$log.user=user$$module$src$log;module$src$log.userAssert=userAssert$$module$src$log;function assertIsName$$module$src$css(name){devAssert$$module$src$log(/^[\w-]+$/.test(name))}var scopeSelectorSupported$$module$src$css;function setScopeSelectorSupportedForTesting$$module$src$css(val){scopeSelectorSupported$$module$src$css=val}function isScopeSelectorSupported$$module$src$css(el){if(scopeSelectorSupported$$module$src$css!==undefined)return scopeSelectorSupported$$module$src$css;return scopeSelectorSupported$$module$src$css=testScopeSelector$$module$src$css(el)}
function testScopeSelector$$module$src$css(el){try{var doc=el.ownerDocument;var testElement=doc.createElement("div");var testChild=doc.createElement("div");testElement.appendChild(testChild);return testElement.querySelector(":scope div")===testChild}catch(e){return false}}function prependSelectorsWith$$module$src$css(selector,distribute){return selector.replace(/^|,/g,"$&"+distribute+" ")}
function escapeCssSelectorIdent$$module$src$css(ident){return cssEscape$$module$third_party$css_escape$css_escape(ident)}function escapeCssSelectorNth$$module$src$css(ident){var escaped=String(ident);devAssert$$module$src$log(escaped.indexOf(")")===-1);return escaped}var module$src$css={};module$src$css.assertIsName=assertIsName$$module$src$css;module$src$css.escapeCssSelectorIdent=escapeCssSelectorIdent$$module$src$css;module$src$css.escapeCssSelectorNth=escapeCssSelectorNth$$module$src$css;
module$src$css.isScopeSelectorSupported=isScopeSelectorSupported$$module$src$css;module$src$css.prependSelectorsWith=prependSelectorsWith$$module$src$css;module$src$css.setScopeSelectorSupportedForTesting=setScopeSelectorSupportedForTesting$$module$src$css;var hasOwn_$$module$src$utils$object=Object.prototype.hasOwnProperty;function map$$module$src$utils$object(opt_initial){var obj=Object.create(null);if(opt_initial)Object.assign(obj,opt_initial);return obj}function dict$$module$src$utils$object(opt_initial){return opt_initial||{}}function hasOwn$$module$src$utils$object(obj,key){return hasOwn_$$module$src$utils$object.call(obj,key)}
function ownProperty$$module$src$utils$object(obj,key){if(hasOwn$$module$src$utils$object(obj,key))return obj[key];else return undefined}
function deepMerge$$module$src$utils$object(target,source,depth){depth=depth===undefined?10:depth;var seen=[];var queue=[];queue.push({t:target,s:source,d:0});var $jscomp$loop$5={};while(queue.length>0){$jscomp$loop$5:{var $jscomp$destructuring$var1=queue.shift();$jscomp$loop$5.$jscomp$loop$prop$t$7=$jscomp$destructuring$var1.t;$jscomp$loop$5.$jscomp$loop$prop$s$6=$jscomp$destructuring$var1.s;$jscomp$loop$5.$jscomp$loop$prop$d$8=$jscomp$destructuring$var1.d;if(seen.includes($jscomp$loop$5.$jscomp$loop$prop$s$6))throw new Error("Source object has a circular reference.");
seen.push($jscomp$loop$5.$jscomp$loop$prop$s$6);if($jscomp$loop$5.$jscomp$loop$prop$t$7===$jscomp$loop$5.$jscomp$loop$prop$s$6)break $jscomp$loop$5;if($jscomp$loop$5.$jscomp$loop$prop$d$8>depth){Object.assign($jscomp$loop$5.$jscomp$loop$prop$t$7,$jscomp$loop$5.$jscomp$loop$prop$s$6);break $jscomp$loop$5}Object.keys($jscomp$loop$5.$jscomp$loop$prop$s$6).forEach(function($jscomp$loop$5){return function(key){var newValue=$jscomp$loop$5.$jscomp$loop$prop$s$6[key];if(hasOwn$$module$src$utils$object($jscomp$loop$5.$jscomp$loop$prop$t$7,
key)){var oldValue=$jscomp$loop$5.$jscomp$loop$prop$t$7[key];if(isObject$$module$src$types(newValue)&&isObject$$module$src$types(oldValue)){queue.push({t:oldValue,s:newValue,d:$jscomp$loop$5.$jscomp$loop$prop$d$8+1});return}}$jscomp$loop$5.$jscomp$loop$prop$t$7[key]=newValue}}($jscomp$loop$5))}$jscomp$loop$5={$jscomp$loop$prop$s$6:$jscomp$loop$5.$jscomp$loop$prop$s$6,$jscomp$loop$prop$t$7:$jscomp$loop$5.$jscomp$loop$prop$t$7,$jscomp$loop$prop$d$8:$jscomp$loop$5.$jscomp$loop$prop$d$8}}return target}
function omit$$module$src$utils$object(o,props){return Object.keys(o).reduce(function(acc,key){if(!props.includes(key))acc[key]=o[key];return acc},{})}var module$src$utils$object={};module$src$utils$object.deepMerge=deepMerge$$module$src$utils$object;module$src$utils$object.dict=dict$$module$src$utils$object;module$src$utils$object.hasOwn=hasOwn$$module$src$utils$object;module$src$utils$object.map=map$$module$src$utils$object;module$src$utils$object.omit=omit$$module$src$utils$object;
module$src$utils$object.ownProperty=ownProperty$$module$src$utils$object;function toUpperCase$$module$src$string(_match,character){return character.toUpperCase()}function prependDashAndToLowerCase$$module$src$string(match){return"-"+match.toLowerCase()}function dashToCamelCase$$module$src$string(name){return name.replace(/-([a-z])/g,toUpperCase$$module$src$string)}function camelCaseToDash$$module$src$string(string){return string.replace(/(?!^)[A-Z]/g,prependDashAndToLowerCase$$module$src$string)}
function dashToUnderline$$module$src$string(name){return name.replace("-","_")}function endsWith$$module$src$string(string,suffix){var index=string.length-suffix.length;return index>=0&&string.indexOf(suffix,index)==index}function startsWith$$module$src$string(string,prefix){if(prefix.length>string.length)return false;return string.lastIndexOf(prefix,0)==0}
function includes$$module$src$string(string,substring,start){if(typeof start!=="number")start=0;if(start+substring.length>string.length)return false;return string.indexOf(substring,start)!==-1}
function expandTemplate$$module$src$string(template,getter,opt_maxIterations){var maxIterations=opt_maxIterations||1;var $jscomp$loop$9={};var i=0;for(;i<maxIterations;$jscomp$loop$9={$jscomp$loop$prop$matches$10:$jscomp$loop$9.$jscomp$loop$prop$matches$10},i++){$jscomp$loop$9.$jscomp$loop$prop$matches$10=0;template=template.replace(/\${([^}]*)}/g,function($jscomp$loop$9){return function(_a,b){$jscomp$loop$9.$jscomp$loop$prop$matches$10++;return getter(b)}}($jscomp$loop$9));if(!$jscomp$loop$9.$jscomp$loop$prop$matches$10)break}return template}
function stringHash32$$module$src$string(str){var $jscomp$destructuring$var2=str;var length=$jscomp$destructuring$var2.length;var hash=5381;for(var i=0;i<length;i++)hash=hash*33^str.charCodeAt(i);return String(hash>>>0)}function trimEnd$$module$src$string(str){if(str.trimEnd)return str.trimEnd();return("_"+str).trim().slice(1)}function trimStart$$module$src$string(str){if(str.trimStart)return str.trimStart();return(str+"_").trim().slice(0,-1)}
function padStart$$module$src$string(s,targetLength,padString){if(s.length>=targetLength)return s;targetLength=targetLength-s.length;var padding=padString;while(targetLength>padding.length)padding+=padString;return padding.slice(0,targetLength)+s}var module$src$string={};module$src$string.camelCaseToDash=camelCaseToDash$$module$src$string;module$src$string.dashToCamelCase=dashToCamelCase$$module$src$string;module$src$string.dashToUnderline=dashToUnderline$$module$src$string;
module$src$string.endsWith=endsWith$$module$src$string;module$src$string.expandTemplate=expandTemplate$$module$src$string;module$src$string.includes=includes$$module$src$string;module$src$string.padStart=padStart$$module$src$string;module$src$string.startsWith=startsWith$$module$src$string;module$src$string.stringHash32=stringHash32$$module$src$string;module$src$string.trimEnd=trimEnd$$module$src$string;module$src$string.trimStart=trimStart$$module$src$string;var HTML_ESCAPE_CHARS$$module$src$dom={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var HTML_ESCAPE_REGEX$$module$src$dom=/(&|<|>|"|'|`)/g;var UPGRADE_TO_CUSTOMELEMENT_PROMISE$$module$src$dom="__AMP_UPG_PRM";var UPGRADE_TO_CUSTOMELEMENT_RESOLVER$$module$src$dom="__AMP_UPG_RES";
function waitForChild$$module$src$dom(parent,checkFunc,callback){if(checkFunc(parent)){callback();return}var win=toWin$$module$src$types(parent.ownerDocument.defaultView);if(win.MutationObserver){var observer=new win.MutationObserver(function(){if(checkFunc(parent)){observer.disconnect();callback()}});observer.observe(parent,{childList:true})}else var interval=win.setInterval(function(){if(checkFunc(parent)){win.clearInterval(interval);callback()}},5)}
function waitForChildPromise$$module$src$dom(parent,checkFunc){return new Promise(function(resolve){waitForChild$$module$src$dom(parent,checkFunc,resolve)})}function waitForBodyOpen$$module$src$dom(doc,callback){waitForChild$$module$src$dom(doc.documentElement,function(){return!!doc.body},callback)}function waitForBodyOpenPromise$$module$src$dom(doc){return new Promise(function(resolve){return waitForBodyOpen$$module$src$dom(doc,resolve)})}
function removeElement$$module$src$dom(element){if(element.parentElement)element.parentElement.removeChild(element)}function removeChildren$$module$src$dom(parent){while(parent.firstChild)parent.removeChild(parent.firstChild)}function copyChildren$$module$src$dom(from,to){var frag=to.ownerDocument.createDocumentFragment();for(var n=from.firstChild;n;n=n.nextSibling)frag.appendChild(n.cloneNode(true));to.appendChild(frag)}
function insertAfterOrAtStart$$module$src$dom(root,element,after){var before=after?after.nextSibling:root.firstChild;root.insertBefore(element,before)}function addAttributesToElement$$module$src$dom(element,attributes){for(var attr in attributes)element.setAttribute(attr,attributes[attr]);return element}function createElementWithAttributes$$module$src$dom(doc,tagName,attributes){var element=doc.createElement(tagName);return addAttributesToElement$$module$src$dom(element,attributes)}
function isConnectedNode$$module$src$dom(node){var connected=node.isConnected;if(connected!==undefined)return connected;var n=node;do{n=rootNodeFor$$module$src$dom(n);if(n.host)n=n.host;else break}while(true);return n.nodeType===Node.DOCUMENT_NODE}function rootNodeFor$$module$src$dom(node){if(Node.prototype.getRootNode)return node.getRootNode()||node;var n;for(n=node;!!n.parentNode&&!isShadowRoot$$module$src$dom(n);n=n.parentNode);return n}
function isShadowRoot$$module$src$dom(value){if(!value)return false;if(value.tagName=="I-AMPHTML-SHADOW-ROOT")return true;return value.nodeType==11&&Object.prototype.toString.call(value)==="[object ShadowRoot]"}function closest$$module$src$dom(element,callback,opt_stopAt){for(var el=element;el&&el!==opt_stopAt;el=el.parentElement)if(callback(el))return el;return null}function closestNode$$module$src$dom(node,callback){for(var n=node;n;n=n.parentNode)if(callback(n))return n;return null}
function closestAncestorElementBySelector$$module$src$dom(element,selector){if(element.closest)return element.closest(selector);return closest$$module$src$dom(element,function(el){return matches$$module$src$dom(el,selector)})}function ancestorElements$$module$src$dom(child,predicate){var ancestors=[];for(var ancestor=child.parentElement;ancestor;ancestor=ancestor.parentElement)if(predicate(ancestor))ancestors.push(ancestor);return ancestors}
function ancestorElementsByTag$$module$src$dom(child,tagName){assertIsName$$module$src$css(tagName);tagName=tagName.toUpperCase();return ancestorElements$$module$src$dom(child,function(el){return el.tagName==tagName})}function childElement$$module$src$dom(parent,callback){for(var child=parent.firstElementChild;child;child=child.nextElementSibling)if(callback(child))return child;return null}
function childElements$$module$src$dom(parent,callback){var children=[];for(var child=parent.firstElementChild;child;child=child.nextElementSibling)if(callback(child))children.push(child);return children}function lastChildElement$$module$src$dom(parent,callback){for(var child=parent.lastElementChild;child;child=child.previousElementSibling)if(callback(child))return child;return null}
function childNodes$$module$src$dom(parent,callback){var nodes=[];for(var child=parent.firstChild;child;child=child.nextSibling)if(callback(child))nodes.push(child);return nodes}function childElementByAttr$$module$src$dom(parent,attr){assertIsName$$module$src$css(attr);return scopedQuerySelector$$module$src$dom(parent,"> ["+attr+"]")}
function lastChildElementByAttr$$module$src$dom(parent,attr){assertIsName$$module$src$css(attr);return lastChildElement$$module$src$dom(parent,function(el){return el.hasAttribute(attr)})}function childElementsByAttr$$module$src$dom(parent,attr){assertIsName$$module$src$css(attr);return scopedQuerySelectorAll$$module$src$dom(parent,"> ["+attr+"]")}
function childElementByTag$$module$src$dom(parent,tagName){assertIsName$$module$src$css(tagName);return scopedQuerySelector$$module$src$dom(parent,"> "+tagName)}function childElementsByTag$$module$src$dom(parent,tagName){assertIsName$$module$src$css(tagName);return scopedQuerySelectorAll$$module$src$dom(parent,"> "+tagName)}
function matches$$module$src$dom(el,selector){var matcher=el.matches||el.webkitMatchesSelector||el.mozMatchesSelector||el.msMatchesSelector||el.oMatchesSelector;if(matcher)return matcher.call(el,selector);return false}function elementByTag$$module$src$dom(element,tagName){assertIsName$$module$src$css(tagName);return element.querySelector(tagName)}
function scopedQuerySelectionFallback$$module$src$dom(root,selector){var unique="i-amphtml-scoped";root.classList.add(unique);var scopedSelector=prependSelectorsWith$$module$src$css(selector,"."+unique);var elements=root.querySelectorAll(scopedSelector);root.classList.remove(unique);return elements}
function scopedQuerySelector$$module$src$dom(root,selector){if(isScopeSelectorSupported$$module$src$css(root))return root.querySelector(prependSelectorsWith$$module$src$css(selector,":scope"));var fallbackResult=scopedQuerySelectionFallback$$module$src$dom(root,selector);return fallbackResult[0]===undefined?null:fallbackResult[0]}
function scopedQuerySelectorAll$$module$src$dom(root,selector){if(isScopeSelectorSupported$$module$src$css(root))return root.querySelectorAll(prependSelectorsWith$$module$src$css(selector,":scope"));return scopedQuerySelectionFallback$$module$src$dom(root,selector)}
function getDataParamsFromAttributes$$module$src$dom(element,opt_computeParamNameFunc,opt_paramPattern){var computeParamNameFunc=opt_computeParamNameFunc||function(key){return key};var $jscomp$destructuring$var3=element;var dataset=$jscomp$destructuring$var3.dataset;var params=dict$$module$src$utils$object();var paramPattern=opt_paramPattern?opt_paramPattern:/^param(.+)/;for(var key in dataset){var matches=key.match(paramPattern);if(matches){var param=matches[1][0].toLowerCase()+matches[1].substr(1);
params[computeParamNameFunc(param)]=dataset[key]}}return params}function hasNextNodeInDocumentOrder$$module$src$dom(element,opt_stopNode){var currentElement=element;do if(currentElement.nextSibling)return true;while((currentElement=currentElement.parentNode)&&currentElement!=opt_stopNode);return false}
function templateContentClone$$module$src$dom(template){if("content"in template)return template.content.cloneNode(true);else{var content=template.ownerDocument.createDocumentFragment();copyChildren$$module$src$dom(template,content);return content}}function iterateCursor$$module$src$dom(iterable,cb){var $jscomp$destructuring$var4=iterable;var length=$jscomp$destructuring$var4.length;for(var i=0;i<length;i++)cb(iterable[i],i)}
function openWindowDialog$$module$src$dom(win,url,target,opt_features){var res;try{res=win.open(url,target,opt_features)}catch(e){dev$$module$src$log().error("DOM","Failed to open url on target: ",target,e)}if(!res&&target!="_top"&&!includes$$module$src$string(opt_features||"","noopener"))res=win.open(url,"_top");return res}
function isJsonScriptTag$$module$src$dom(element){return element.tagName=="SCRIPT"&&element.hasAttribute("type")&&element.getAttribute("type").toUpperCase()=="APPLICATION/JSON"}function isJsonLdScriptTag$$module$src$dom(element){return element.tagName=="SCRIPT"&&element.getAttribute("type").toUpperCase()=="APPLICATION/LD+JSON"}function isRTL$$module$src$dom(doc){var dir=doc.body.getAttribute("dir")||doc.documentElement.getAttribute("dir")||"ltr";return dir=="rtl"}
function escapeHtml$$module$src$dom(text){if(!text)return text;return text.replace(HTML_ESCAPE_REGEX$$module$src$dom,escapeHtmlChar$$module$src$dom)}function escapeHtmlChar$$module$src$dom(c){return HTML_ESCAPE_CHARS$$module$src$dom[c]}function tryFocus$$module$src$dom(element){try{element.focus()}catch(e){}}function isIframed$$module$src$dom(win){return win.parent&&win.parent!=win}
function isAmpElement$$module$src$dom(element){var tag=element.tagName;return startsWith$$module$src$string(tag,"AMP-")&&!(tag=="AMP-STICKY-AD-TOP-PADDING"||tag=="AMP-BODY")}
function whenUpgradedToCustomElement$$module$src$dom(element){devAssert$$module$src$log(isAmpElement$$module$src$dom(element),"element is not AmpElement");if(element.createdCallback)return Promise.resolve(element);if(!element[UPGRADE_TO_CUSTOMELEMENT_PROMISE$$module$src$dom]){var deferred=new Deferred$$module$src$utils$promise;element[UPGRADE_TO_CUSTOMELEMENT_PROMISE$$module$src$dom]=deferred.promise;element[UPGRADE_TO_CUSTOMELEMENT_RESOLVER$$module$src$dom]=deferred.resolve}return element[UPGRADE_TO_CUSTOMELEMENT_PROMISE$$module$src$dom]}
function fullscreenEnter$$module$src$dom(element){var requestFs=element.requestFullscreen||element.requestFullScreen||element.webkitRequestFullscreen||element.webkitEnterFullscreen||element.msRequestFullscreen||element.mozRequestFullScreen;if(requestFs)requestFs.call(element)}
function fullscreenExit$$module$src$dom(element){var elementBoundExit=element.cancelFullScreen||element.exitFullscreen||element.webkitExitFullscreen||element.webkitCancelFullScreen||element.mozCancelFullScreen||element.msExitFullscreen;if(elementBoundExit){elementBoundExit.call(element);return}var $jscomp$destructuring$var5=element;var ownerDocument=$jscomp$destructuring$var5.ownerDocument;if(!ownerDocument)return;var docBoundExit=ownerDocument.cancelFullScreen||ownerDocument.exitFullscreencancelFullScreen||
ownerDocument.webkitExitFullscreencancelFullScreen||ownerDocument.webkitCancelFullScreencancelFullScreen||ownerDocument.mozCancelFullScreencancelFullScreen||ownerDocument.msExitFullscreen;if(docBoundExit)docBoundExit.call(ownerDocument)}
function isFullscreenElement$$module$src$dom(element){var $jscomp$destructuring$var6=element;var webkitDisplayingFullscreen=$jscomp$destructuring$var6.webkitDisplayingFullscreen;if(webkitDisplayingFullscreen!==undefined)return webkitDisplayingFullscreen;var $jscomp$destructuring$var7=element;var ownerDocument=$jscomp$destructuring$var7.ownerDocument;if(!ownerDocument)return false;var fullscreenElement=ownerDocument.fullscreenElement||ownerDocument.webkitFullscreenElement||ownerDocument.mozFullScreenElement||
ownerDocument.webkitCurrentFullScreenElement;return fullscreenElement==element}function isEnabled$$module$src$dom(element){return!(element.disabled||matches$$module$src$dom(element,":disabled"))}function domOrderComparator$$module$src$dom(element1,element2){if(element1===element2)return 0;var pos=element1.compareDocumentPosition(element2);var precedingOrContains=Node.DOCUMENT_POSITION_PRECEDING|Node.DOCUMENT_POSITION_CONTAINS;if(pos&precedingOrContains)return 1;return-1}
function toggleAttribute$$module$src$dom(element,name,forced){var hasAttribute=element.hasAttribute(name);var enabled=forced!==undefined?forced:!hasAttribute;if(enabled!==hasAttribute)if(enabled)element.setAttribute(name,"");else element.removeAttribute(name);return enabled}
function getVerticalScrollbarWidth$$module$src$dom(win){var $jscomp$destructuring$var8=win.document;var documentElement=$jscomp$destructuring$var8.documentElement;var windowWidth=win.innerWidth;var documentWidth=documentElement.clientWidth;return windowWidth-documentWidth}var module$src$dom={};module$src$dom.UPGRADE_TO_CUSTOMELEMENT_PROMISE=UPGRADE_TO_CUSTOMELEMENT_PROMISE$$module$src$dom;module$src$dom.UPGRADE_TO_CUSTOMELEMENT_RESOLVER=UPGRADE_TO_CUSTOMELEMENT_RESOLVER$$module$src$dom;
module$src$dom.addAttributesToElement=addAttributesToElement$$module$src$dom;module$src$dom.ancestorElements=ancestorElements$$module$src$dom;module$src$dom.ancestorElementsByTag=ancestorElementsByTag$$module$src$dom;module$src$dom.childElement=childElement$$module$src$dom;module$src$dom.childElementByAttr=childElementByAttr$$module$src$dom;module$src$dom.childElementByTag=childElementByTag$$module$src$dom;module$src$dom.childElements=childElements$$module$src$dom;
module$src$dom.childElementsByAttr=childElementsByAttr$$module$src$dom;module$src$dom.childElementsByTag=childElementsByTag$$module$src$dom;module$src$dom.childNodes=childNodes$$module$src$dom;module$src$dom.closest=closest$$module$src$dom;module$src$dom.closestAncestorElementBySelector=closestAncestorElementBySelector$$module$src$dom;module$src$dom.closestNode=closestNode$$module$src$dom;module$src$dom.copyChildren=copyChildren$$module$src$dom;module$src$dom.createElementWithAttributes=createElementWithAttributes$$module$src$dom;
module$src$dom.domOrderComparator=domOrderComparator$$module$src$dom;module$src$dom.elementByTag=elementByTag$$module$src$dom;module$src$dom.escapeHtml=escapeHtml$$module$src$dom;module$src$dom.fullscreenEnter=fullscreenEnter$$module$src$dom;module$src$dom.fullscreenExit=fullscreenExit$$module$src$dom;module$src$dom.getDataParamsFromAttributes=getDataParamsFromAttributes$$module$src$dom;module$src$dom.getVerticalScrollbarWidth=getVerticalScrollbarWidth$$module$src$dom;
module$src$dom.hasNextNodeInDocumentOrder=hasNextNodeInDocumentOrder$$module$src$dom;module$src$dom.insertAfterOrAtStart=insertAfterOrAtStart$$module$src$dom;module$src$dom.isAmpElement=isAmpElement$$module$src$dom;module$src$dom.isConnectedNode=isConnectedNode$$module$src$dom;module$src$dom.isEnabled=isEnabled$$module$src$dom;module$src$dom.isFullscreenElement=isFullscreenElement$$module$src$dom;module$src$dom.isIframed=isIframed$$module$src$dom;module$src$dom.isJsonLdScriptTag=isJsonLdScriptTag$$module$src$dom;
module$src$dom.isJsonScriptTag=isJsonScriptTag$$module$src$dom;module$src$dom.isRTL=isRTL$$module$src$dom;module$src$dom.isShadowRoot=isShadowRoot$$module$src$dom;module$src$dom.iterateCursor=iterateCursor$$module$src$dom;module$src$dom.lastChildElement=lastChildElement$$module$src$dom;module$src$dom.lastChildElementByAttr=lastChildElementByAttr$$module$src$dom;module$src$dom.matches=matches$$module$src$dom;module$src$dom.openWindowDialog=openWindowDialog$$module$src$dom;
module$src$dom.removeChildren=removeChildren$$module$src$dom;module$src$dom.removeElement=removeElement$$module$src$dom;module$src$dom.rootNodeFor=rootNodeFor$$module$src$dom;module$src$dom.scopedQuerySelector=scopedQuerySelector$$module$src$dom;module$src$dom.scopedQuerySelectorAll=scopedQuerySelectorAll$$module$src$dom;module$src$dom.templateContentClone=templateContentClone$$module$src$dom;module$src$dom.toggleAttribute=toggleAttribute$$module$src$dom;module$src$dom.tryFocus=tryFocus$$module$src$dom;
module$src$dom.waitForBodyOpen=waitForBodyOpen$$module$src$dom;module$src$dom.waitForBodyOpenPromise=waitForBodyOpenPromise$$module$src$dom;module$src$dom.waitForChild=waitForChild$$module$src$dom;module$src$dom.waitForChildPromise=waitForChildPromise$$module$src$dom;module$src$dom.whenUpgradedToCustomElement=whenUpgradedToCustomElement$$module$src$dom;var LOAD_FAILURE_PREFIX$$module$src$event_helper="Failed to load:";var MEDIA_LOAD_FAILURE_SRC_PROPERTY$$module$src$event_helper="__AMP_MEDIA_LOAD_FAILURE_SRC";
function createCustomEvent$$module$src$event_helper(win,type,detail,opt_eventInit){var eventInit={detail:detail};Object.assign(eventInit,opt_eventInit);if(typeof win.CustomEvent=="function")return new win.CustomEvent(type,eventInit);else{var e=win.document.createEvent("CustomEvent");e.initCustomEvent(type,!!eventInit.bubbles,!!eventInit.cancelable,detail);return e}}
function listen$$module$src$event_helper(element,eventType,listener,opt_evtListenerOpts){return internalListenImplementation$$module$src$event_helper_listen(element,eventType,listener,opt_evtListenerOpts)}function getData$$module$src$event_helper(event){return event.data}function getDetail$$module$src$event_helper(event){return event.detail}
function listenOnce$$module$src$event_helper(element,eventType,listener,opt_evtListenerOpts){var localListener=listener;var unlisten=internalListenImplementation$$module$src$event_helper_listen(element,eventType,function(event){try{localListener(event)}finally{localListener=null;unlisten()}},opt_evtListenerOpts);return unlisten}
function listenOncePromise$$module$src$event_helper(element,eventType,opt_evtListenerOpts,opt_cancel){var unlisten;var eventPromise=new Promise(function(resolve){unlisten=listenOnce$$module$src$event_helper(element,eventType,resolve,opt_evtListenerOpts)});eventPromise.then(unlisten,unlisten);if(opt_cancel)opt_cancel(unlisten);return eventPromise}
function isLoaded$$module$src$event_helper(eleOrWindow){return!!(eleOrWindow.complete||eleOrWindow.readyState=="complete"||isHTMLMediaElement$$module$src$event_helper(eleOrWindow)&&eleOrWindow.readyState>0||eleOrWindow.document&&eleOrWindow.document.readyState=="complete")}
function loadPromise$$module$src$event_helper(eleOrWindow){var unlistenLoad;var unlistenError;if(isLoaded$$module$src$event_helper(eleOrWindow))return Promise.resolve(eleOrWindow);var isMediaElement=isHTMLMediaElement$$module$src$event_helper(eleOrWindow);if(isMediaElement&&eleOrWindow[MEDIA_LOAD_FAILURE_SRC_PROPERTY$$module$src$event_helper]===eleOrWindow.currentSrc)return Promise.reject(eleOrWindow);var loadingPromise=new Promise(function(resolve,reject){if(isMediaElement)unlistenLoad=listenOnce$$module$src$event_helper(eleOrWindow,
"loadedmetadata",resolve,{capture:true});else unlistenLoad=listenOnce$$module$src$event_helper(eleOrWindow,"load",resolve);if(!eleOrWindow.tagName)return;var errorTarget=eleOrWindow;if(isMediaElement&&!eleOrWindow.hasAttribute("src")){errorTarget=lastChildElement$$module$src$dom(eleOrWindow,function(child){return child.tagName==="SOURCE"});if(!errorTarget)return reject(new Error("Media has no source."))}unlistenError=listenOnce$$module$src$event_helper(errorTarget,"error",reject)});return loadingPromise.then(function(){if(unlistenError)unlistenError();
return eleOrWindow},function(){if(unlistenLoad)unlistenLoad();failedToLoad$$module$src$event_helper(eleOrWindow)})}function failedToLoad$$module$src$event_helper(eleOrWindow){if(isHTMLMediaElement$$module$src$event_helper(eleOrWindow))eleOrWindow[MEDIA_LOAD_FAILURE_SRC_PROPERTY$$module$src$event_helper]=eleOrWindow.currentSrc||true;var target=eleOrWindow;if(target&&target.src)target=target.src;throw user$$module$src$log().createError(LOAD_FAILURE_PREFIX$$module$src$event_helper,target);}
function isHTMLMediaElement$$module$src$event_helper(eleOrWindow){return eleOrWindow.tagName==="AUDIO"||eleOrWindow.tagName==="VIDEO"}function isLoadErrorMessage$$module$src$event_helper(message){return message.indexOf(LOAD_FAILURE_PREFIX$$module$src$event_helper)!=-1}var module$src$event_helper={};module$src$event_helper.MEDIA_LOAD_FAILURE_SRC_PROPERTY=MEDIA_LOAD_FAILURE_SRC_PROPERTY$$module$src$event_helper;module$src$event_helper.createCustomEvent=createCustomEvent$$module$src$event_helper;
module$src$event_helper.getData=getData$$module$src$event_helper;module$src$event_helper.getDetail=getDetail$$module$src$event_helper;module$src$event_helper.isLoadErrorMessage=isLoadErrorMessage$$module$src$event_helper;module$src$event_helper.isLoaded=isLoaded$$module$src$event_helper;module$src$event_helper.listen=listen$$module$src$event_helper;module$src$event_helper.listenOnce=listenOnce$$module$src$event_helper;module$src$event_helper.listenOncePromise=listenOncePromise$$module$src$event_helper;
module$src$event_helper.loadPromise=loadPromise$$module$src$event_helper;var JSONScalarDef$$module$src$json;var JSONObjectDef$$module$src$json;var JSONArrayDef$$module$src$json;var JSONValueDef$$module$src$json;function recreateNonProtoObject$$module$src$json(obj){var copy=Object.create(null);for(var k in obj){if(!hasOwnProperty$$module$src$json(obj,k))continue;var v=obj[k];copy[k]=isObject$$module$src$types(v)?recreateNonProtoObject$$module$src$json(v):v}return copy}
function getValueForExpr$$module$src$json(obj,expr){if(expr==".")return obj;var parts=expr.split(".");var value=obj;for(var i=0;i<parts.length;i++){var part=parts[i];if(part&&value&&value[part]!==undefined&&hasOwnProperty$$module$src$json(value,part)){value=value[part];continue}value=undefined;break}return value}function parseJson$$module$src$json(json){return JSON.parse(json)}
function tryParseJson$$module$src$json(json,opt_onFailed){try{return parseJson$$module$src$json(json)}catch(e){if(opt_onFailed)opt_onFailed(e);return null}}
function getChildJsonConfig$$module$src$json(element){var scripts=childElementsByTag$$module$src$dom(element,"script");var n=scripts.length;if(n!==1)throw new Error("Found "+scripts.length+" <script> children. Expected 1.");var script=scripts[0];if(!isJsonScriptTag$$module$src$dom(script))throw new Error('<script> child must have type="application/json"');try{return parseJson$$module$src$json(script.textContent)}catch(unusedError){throw new Error("Failed to parse <script> contents. Is it valid JSON?");
}}
function deepEquals$$module$src$json(a,b,depth){depth=depth===undefined?5:depth;if(!isFinite(depth)||depth<0)throw new Error("Invalid depth: "+depth);if(a===b)return true;var queue=[{a:a,b:b,depth:depth}];while(queue.length>0){var $jscomp$destructuring$var9=queue.shift();var a$1=$jscomp$destructuring$var9.a;var b$2=$jscomp$destructuring$var9.b;var depth$3=$jscomp$destructuring$var9.depth;if(depth$3>0)if(typeof a$1!==typeof b$2)return false;else if(Array.isArray(a$1)&&Array.isArray(b$2)){if(a$1.length!==b$2.length)return false;
for(var i=0;i<a$1.length;i++)queue.push({a:a$1[i],b:b$2[i],depth:depth$3-1});continue}else if(a$1&&b$2&&typeof a$1==="object"&&typeof b$2==="object"){var keysA=Object.keys(a$1);var keysB=Object.keys(b$2);if(keysA.length!==keysB.length)return false;for(var i$4=0;i$4<keysA.length;i$4++){var k=keysA[i$4];queue.push({a:a$1[k],b:b$2[k],depth:depth$3-1})}continue}if(a$1!==b$2)return false}return true}
function hasOwnProperty$$module$src$json(obj,key){if(obj==null||typeof obj!="object")return false;return Object.prototype.hasOwnProperty.call(obj,key)}function jsonConfiguration$$module$src$json(obj){return obj}function jsonLiteral$$module$src$json(value){return value}function includeJsonLiteral$$module$src$json(value){return value}var module$src$json={};module$src$json.deepEquals=deepEquals$$module$src$json;module$src$json.getChildJsonConfig=getChildJsonConfig$$module$src$json;
module$src$json.getValueForExpr=getValueForExpr$$module$src$json;module$src$json.includeJsonLiteral=includeJsonLiteral$$module$src$json;module$src$json.jsonConfiguration=jsonConfiguration$$module$src$json;module$src$json.jsonLiteral=jsonLiteral$$module$src$json;module$src$json.parseJson=parseJson$$module$src$json;module$src$json.recreateNonProtoObject=recreateNonProtoObject$$module$src$json;module$src$json.tryParseJson=tryParseJson$$module$src$json;var TAG$$module$extensions$amp_viewer_integration$0_1$messaging$messaging="amp-viewer-messaging";var APP$$module$extensions$amp_viewer_integration$0_1$messaging$messaging="__AMPHTML__";var MessageType$$module$extensions$amp_viewer_integration$0_1$messaging$messaging={REQUEST:"q",RESPONSE:"s"};var Message$$module$extensions$amp_viewer_integration$0_1$messaging$messaging;var RequestHandler$$module$extensions$amp_viewer_integration$0_1$messaging$messaging;
function parseMessage$$module$extensions$amp_viewer_integration$0_1$messaging$messaging(message){if(typeof message!="string")return message;if(message.charAt(0)!="{")return null;try{return parseJson$$module$src$json(message)}catch(e){return null}}var WindowPortEmulator$$module$extensions$amp_viewer_integration$0_1$messaging$messaging=function(win,origin,target){this.win=win;this.origin_=origin;this.target_=target};
WindowPortEmulator$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.addEventListener=function(eventType,handler){var $jscomp$this=this;this.win.addEventListener("message",function(e){if(e.origin==$jscomp$this.origin_&&e.source==$jscomp$this.target_&&getData$$module$src$event_helper(e)["app"]==APP$$module$extensions$amp_viewer_integration$0_1$messaging$messaging)handler(e)})};
WindowPortEmulator$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.postMessage=function(data){this.target_.postMessage(data,this.origin_)};WindowPortEmulator$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.start=function(){};
var Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging=function(win,port,opt_isWebview,opt_token){this.win=win;this.port_=port;this.isWebview_=!!opt_isWebview;this.token_=opt_token||null;this.requestIdCounter_=0;this.waitingForResponse_={};this.messageHandlers_={};this.defaultHandler_=null;this.port_.addEventListener("message",this.handleMessage_.bind(this));this.port_.start()};
Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.registerHandler=function(messageName,requestHandler){this.messageHandlers_[messageName]=requestHandler};Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.unregisterHandler=function(messageName){delete this.messageHandlers_[messageName]};
Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.setDefaultHandler=function(requestHandler){this.defaultHandler_=requestHandler};
Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.handleMessage_=function(event){var message=parseMessage$$module$extensions$amp_viewer_integration$0_1$messaging$messaging(getData$$module$src$event_helper(event));if(!message)return;if(message.type==MessageType$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.REQUEST)this.handleRequest_(message);else if(message.type==MessageType$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.RESPONSE)this.handleResponse_(message)};
Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.sendRequest=function(messageName,messageData,awaitResponse){var $jscomp$this=this;var requestId=++this.requestIdCounter_;var promise=undefined;if(awaitResponse)promise=new Promise(function(resolve,reject){$jscomp$this.waitingForResponse_[requestId]={resolve:resolve,reject:reject}});this.sendMessage_({app:APP$$module$extensions$amp_viewer_integration$0_1$messaging$messaging,requestid:requestId,type:MessageType$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.REQUEST,
name:messageName,data:messageData,rsvp:awaitResponse});return promise};Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.sendResponse_=function(requestId,messageName,messageData){this.sendMessage_({app:APP$$module$extensions$amp_viewer_integration$0_1$messaging$messaging,requestid:requestId,type:MessageType$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.RESPONSE,name:messageName,data:messageData})};
Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.sendResponseError_=function(requestId,messageName,reason){var errString=this.errorToString_(reason);this.logError_(TAG$$module$extensions$amp_viewer_integration$0_1$messaging$messaging+": sendResponseError_, Message name: "+messageName,errString);this.sendMessage_({app:APP$$module$extensions$amp_viewer_integration$0_1$messaging$messaging,requestid:requestId,type:MessageType$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.RESPONSE,
name:messageName,data:null,error:errString})};Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.sendMessage_=function(message){var finalMessage=Object.assign(message,{});if(this.token_)finalMessage["messagingToken"]=this.token_;this.port_.postMessage(this.isWebview_?JSON.stringify(finalMessage):finalMessage)};
Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.handleRequest_=function(message){var $jscomp$this=this;var handler=this.messageHandlers_[message.name];if(!handler)handler=this.defaultHandler_;if(!handler){var error=new Error("Cannot handle request because handshake is not yet confirmed!");error.args=message.name;throw error;}var promise=handler(message.name,message.data,!!message.rsvp);if(message.rsvp){var requestId=message.requestid;if(!promise){this.sendResponseError_(requestId,
message.name,new Error("no response"));throw new Error("expected response but none given: "+message.name);}promise.then(function(data){$jscomp$this.sendResponse_(requestId,message.name,data)},function(reason){$jscomp$this.sendResponseError_(requestId,message.name,reason)})}};
Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.handleResponse_=function(message){var requestId=message.requestid;var pending=this.waitingForResponse_[requestId];if(pending){delete this.waitingForResponse_[requestId];if(message.error){this.logError_(TAG$$module$extensions$amp_viewer_integration$0_1$messaging$messaging+": handleResponse_ error: ",message.error);pending.reject(new Error("Request "+message.name+" failed: "+message.error))}else pending.resolve(message.data)}};
Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.logError_=function(state,opt_data){var stateStr="amp-messaging-error-logger: "+state;var dataStr=" data: "+this.errorToString_(opt_data);stateStr+=dataStr;this.win["viewerState"]=stateStr};Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.prototype.errorToString_=function(err){return err?err.message?err.message:String(err):"unknown error"};
var module$extensions$amp_viewer_integration$0_1$messaging$messaging={};module$extensions$amp_viewer_integration$0_1$messaging$messaging.APP=APP$$module$extensions$amp_viewer_integration$0_1$messaging$messaging;module$extensions$amp_viewer_integration$0_1$messaging$messaging.Message;module$extensions$amp_viewer_integration$0_1$messaging$messaging.MessageType=MessageType$$module$extensions$amp_viewer_integration$0_1$messaging$messaging;
module$extensions$amp_viewer_integration$0_1$messaging$messaging.Messaging=Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging;module$extensions$amp_viewer_integration$0_1$messaging$messaging.RequestHandler;module$extensions$amp_viewer_integration$0_1$messaging$messaging.WindowPortEmulator=WindowPortEmulator$$module$extensions$amp_viewer_integration$0_1$messaging$messaging;module$extensions$amp_viewer_integration$0_1$messaging$messaging.parseMessage=parseMessage$$module$extensions$amp_viewer_integration$0_1$messaging$messaging;var CHANNEL_OPEN_MSG$$module$extensions$amp_viewer_integration$0_1$examples$amp_viewer_host="channelOpen";
var AmpViewerHost$$module$extensions$amp_viewer_integration$0_1$examples$amp_viewer_host=function(win,ampIframe,frameOrigin,messageHandler,opt_logsId,opt_isWebview,opt_isHandshakePoll){this.win=win;this.ampIframe_=ampIframe;this.messageHandler_=messageHandler;this.isWebview_=!!opt_isWebview;this.logsId=opt_logsId;if(this.isWebview_||opt_isHandshakePoll)this.pollingIntervalId_=setInterval(this.initiateHandshake_.bind(this,this.intervalCtr),1E3);else this.waitForHandshake_(frameOrigin)};
AmpViewerHost$$module$extensions$amp_viewer_integration$0_1$examples$amp_viewer_host.prototype.initiateHandshake_=function(){this.log("initiateHandshake_");if(this.ampIframe_){var channel=new MessageChannel;var message={app:APP$$module$extensions$amp_viewer_integration$0_1$messaging$messaging,name:"handshake-poll"};message=this.isWebview_?JSON.stringify(message):message;this.ampIframe_.contentWindow.postMessage(message,"*",[channel.port2]);channel.port1.onmessage=function(e){var data=this.isWebview_?
JSON.parse(e.data):e.data;if(this.isChannelOpen_(data)){this.win.clearInterval(this.pollingIntervalId_);this.log("messaging established!");this.completeHandshake_(channel.port1,data.requestid)}else this.messageHandler_(data.name,data.data,data.rsvp)}.bind(this)}};
AmpViewerHost$$module$extensions$amp_viewer_integration$0_1$examples$amp_viewer_host.prototype.waitForHandshake_=function(targetOrigin){this.log("awaitHandshake_");var unlisten=null;var target=this.ampIframe_.contentWindow;var listener=function(event){if(event.origin==targetOrigin&&this.isChannelOpen_(event.data)&&(!event.source||event.source==target)){this.log(" messaging established with ",targetOrigin);unlisten();var port=new WindowPortEmulator$$module$extensions$amp_viewer_integration$0_1$messaging$messaging(this.win,
targetOrigin,target);this.completeHandshake_(port,event.data.requestid)}}.bind(this);unlisten=listen$$module$src$event_helper(this.win,"message",listener)};
AmpViewerHost$$module$extensions$amp_viewer_integration$0_1$examples$amp_viewer_host.prototype.completeHandshake_=function(port,requestId){var message={app:APP$$module$extensions$amp_viewer_integration$0_1$messaging$messaging,requestid:requestId,type:MessageType$$module$extensions$amp_viewer_integration$0_1$messaging$messaging.RESPONSE};message=this.isWebview_?JSON.stringify(message):message;this.log("posting Message",message);port.postMessage(message);this.messaging_=new Messaging$$module$extensions$amp_viewer_integration$0_1$messaging$messaging(this.win,
port);this.messaging_.setDefaultHandler(this.messageHandler_);this.sendRequest("visibilitychange",{state:this.visibilityState_,prerenderSize:this.prerenderSize},true)};AmpViewerHost$$module$extensions$amp_viewer_integration$0_1$examples$amp_viewer_host.prototype.isChannelOpen_=function(eventData){return eventData.app==APP$$module$extensions$amp_viewer_integration$0_1$messaging$messaging&&eventData.name==CHANNEL_OPEN_MSG$$module$extensions$amp_viewer_integration$0_1$examples$amp_viewer_host};
AmpViewerHost$$module$extensions$amp_viewer_integration$0_1$examples$amp_viewer_host.prototype.sendRequest=function(type,data,awaitResponse){this.log("sendRequest");if(!this.messaging_)return;return this.messaging_.sendRequest(type,data,awaitResponse)};AmpViewerHost$$module$extensions$amp_viewer_integration$0_1$examples$amp_viewer_host.prototype.log=function(){var var_args=Array.prototype.slice.call(arguments,0);var_args.unshift("[ViewerHost "+this.logsId+"]");console.log.apply(console,var_args)};
self.AmpViewerHost=AmpViewerHost$$module$extensions$amp_viewer_integration$0_1$examples$amp_viewer_host;var module$extensions$amp_viewer_integration$0_1$examples$amp_viewer_host={};module$extensions$amp_viewer_integration$0_1$examples$amp_viewer_host.AmpViewerHost=AmpViewerHost$$module$extensions$amp_viewer_integration$0_1$examples$amp_viewer_host;})();

//# sourceMappingURL=amp-viewer-host.js.map
