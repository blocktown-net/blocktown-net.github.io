(self.AMP=self.AMP||[]).push({n:"amp-user-notification",v:"1910151804560",f:(function(AMP,_){
var m,n="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},p;if("function"==typeof Object.setPrototypeOf)p=Object.setPrototypeOf;else{var q;a:{var t={a:!0},u={};try{u.__proto__=t;q=u.a;break a}catch(a){}q=!1}p=q?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var v=p;function w(){var a,b;this.promise=new Promise(function(c,g){a=c;b=g});this.resolve=a;this.reject=b};function x(){this.h=0;this.R=Promise.resolve();this.O=function(){};this.P=function(){}}x.prototype.onQueueEmpty=function(a){this.O=a;0==this.h&&a()};x.prototype.onQueueNotEmpty=function(a){this.P=a;0<this.h&&a()};x.prototype.registerUI=function(a){var b=this;0==this.h&&this.P();this.h++;var c=this.R.then(function(){return a().then(function(){b.h--;0==b.h&&b.O()})});return this.R=c};function y(a,b){b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(c){return b}};var aa=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function z(a){var b=Object.create(null);if(!a)return b;for(var c;c=aa.exec(a);){var g=y(c[1],c[1]),d=c[2]?y(c[2].replace(/\+/g," "),c[2]):"";b[g]=d}return b};var A="";function ba(a){for(var b=null,c="",g=0;g<arguments.length;g++){var d=arguments[g];if(d instanceof Error&&!b){b=void 0;var e=Object.getOwnPropertyDescriptor(d,"message");if(e&&e.writable)b=d;else{e=d.stack;var f=Error(d.message);for(b in d)f[b]=d[b];f.stack=e;b=f}}else c&&(c+=" "),c+=d}b?c&&(b.message=c+": "+b.message):b=Error(c);return b}function ca(a){var b=ba.apply(null,arguments);setTimeout(function(){self.__AMP_REPORT_ERROR(b);throw b;})}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};
var B=self.__AMP_LOG;function C(){if(!B.user)throw Error("failed to call initLogConstructor");return B.user}function D(){if(B.dev)return B.dev;throw Error("failed to call initLogConstructor");}function E(a,b,c,g,d){return C().assert(a,b,c,g,d,void 0,void 0,void 0,void 0,void 0,void 0)};function F(a){return a||{}};function G(){var a=100;this.U=a;this.C=this.G=0;this.o=Object.create(null)}G.prototype.has=function(a){return!!this.o[a]};G.prototype.get=function(a){var b=this.o[a];if(b)return b.access=++this.C,b.payload};G.prototype.put=function(a,b){this.has(a)||this.G++;this.o[a]={payload:b,access:this.C};if(!(this.G<=this.U)){D().warn("lru-cache","Trimming LRU cache");a=this.o;var c=this.C+1,g;for(g in a){var d=a[g].access;if(d<c){c=d;var e=g}}void 0!==e&&(delete a[e],this.G--)}};F({c:!0,v:!0,a:!0,ad:!0,action:!0});var H,I;
function J(a,b){var c=void 0===c?"source":c;E(null!=a,"%s %s must be available",b,c);var g=a;a=g;if("string"==typeof a){H||(H=self.document.createElement("a"),I=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new G));var d=I,e=H;if(d&&d.has(a))a=d.get(a);else{e.href=a;e.protocol||(e.href=e.href);var f={href:e.href,protocol:e.protocol,host:e.host,hostname:e.hostname,port:"0"==e.port?"":e.port,pathname:e.pathname,search:e.search,hash:e.hash,origin:null};"/"!==f.pathname[0]&&(f.pathname="/"+f.pathname);
if("http:"==f.protocol&&80==f.port||"https:"==f.protocol&&443==f.port)f.port="",f.host=f.hostname;f.origin=e.origin&&"null"!=e.origin?e.origin:"data:"!=f.protocol&&f.host?f.protocol+"//"+f.host:f.href;e=self;if(e.__AMP_MODE)e=e.__AMP_MODE;else{var h=self.AMP_CONFIG||{};var k=!!h.test||!(!e.__AMP_TEST&&!e.__karma__);var l=e.__karma__&&e.__karma__.config.amp.testOnIe,U=!!h.localDev||k,r=z(e.location.originalHash||e.location.hash);h=h.spt;var da=z(e.location.search);A||(A=U?"1910151804560":e.AMP_CONFIG&&
e.AMP_CONFIG.v?e.AMP_CONFIG.v:"011910151804560");k={localDev:U,development:!!(0<=["1","actions","amp","amp4ads","amp4email"].indexOf(r.development)||e.AMP_DEV_MODE),examiner:"2"==r.development,filter:r.filter,geoOverride:r["amp-geo"],userLocationOverride:r["amp-user-location"],minified:!0,lite:void 0!=da.amp_lite,test:k,testIe:l,log:r.log,version:"1910151804560",rtvVersion:A,singlePassType:h};e=e.__AMP_MODE=k}f=e.test&&Object.freeze?Object.freeze(f):f;d&&d.put(a,f);a=f}}(d="https:"==a.protocol||"localhost"==
a.hostname||"127.0.0.1"==a.hostname)||(a=a.hostname,d=a.length-10,d=0<=d&&a.indexOf(".localhost",d)==d);E(d||/^(\/\/)/.test(g),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',b,c,g)};function ea(a){var b="";try{"localStorage"in a&&(b=a.localStorage.getItem("amp-experiment-toggles"))}catch(d){D().warn("EXPERIMENTS","Failed to retrieve experiments from localStorage.")}var c=b?b.split(/\s*,\s*/g):[];a=Object.create(null);for(var g=0;g<c.length;g++)0!=c[g].length&&("-"==c[g][0]?a[c[g].substr(1)]=!1:a[c[g]]=!0);return a};function fa(a){var b=a.ownerDocument.defaultView,c=b.__AMP_TOP||(b.__AMP_TOP=b),g=b!=c;var d=c;if(d.__AMP__EXPERIMENT_TOGGLES)var e=d.__AMP__EXPERIMENT_TOGGLES;else{d.__AMP__EXPERIMENT_TOGGLES=Object.create(null);e=d.__AMP__EXPERIMENT_TOGGLES;if(d.AMP_CONFIG)for(var f in d.AMP_CONFIG){var h=d.AMP_CONFIG[f];"number"===typeof h&&0<=h&&1>=h&&(e[f]=Math.random()<h)}if(d.AMP_CONFIG&&Array.isArray(d.AMP_CONFIG["allow-doc-opt-in"])&&0<d.AMP_CONFIG["allow-doc-opt-in"].length&&(f=d.AMP_CONFIG["allow-doc-opt-in"],
h=d.document.head.querySelector('meta[name="amp-experiments-opt-in"]'))){h=h.getAttribute("content").split(",");for(var k=0;k<h.length;k++)-1!=f.indexOf(h[k])&&(e[h[k]]=!0)}Object.assign(e,ea(d));if(d.AMP_CONFIG&&Array.isArray(d.AMP_CONFIG["allow-url-opt-in"])&&0<d.AMP_CONFIG["allow-url-opt-in"].length)for(f=d.AMP_CONFIG["allow-url-opt-in"],d=z(d.location.originalHash||d.location.hash),h=0;h<f.length;h++)k=d["e-"+f[h]],"1"==k&&(e[f[h]]=!0),"0"==k&&(e[f[h]]=!1)}var l=!!e["ampdoc-fie"];g&&!l?a=K(b,
"url-replace")?L(b,"url-replace"):null:(a=M(a),a=N(a),a=K(a,"url-replace")?L(a,"url-replace"):null);return a}function O(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return L(a,b)}function M(a){return a.nodeType?O((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function N(a){a=M(a);return a.isSingleDoc()?a.win:a}function L(a,b){K(a,b);var c=P(a);a=c[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}
function Q(a,b){var c=R(a,b);if(c)return c;a=P(a);a[b]=ha();return a[b].promise}function R(a,b){var c=P(a)[b];if(c){if(c.promise)return c.promise;L(a,b);return c.promise=Promise.resolve(c.obj)}return null}function P(a){var b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}function K(a,b){a=a.__AMP_SERVICES&&a.__AMP_SERVICES[b];return!(!a||!a.ctor&&!a.obj)}
function ha(){var a=new w,b=a,c=b.promise,g=b.resolve;b=b.reject;c.catch(function(){});return{obj:null,promise:c,resolve:g,reject:b,context:null,ctor:null}};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function ia(a){var b=R(N(a),"geo");if(b)return b;var c=M(a);return c.waitForBodyOpen().then(function(){var a=c.win;var b=c.win.document.head;if(b){var e={};b=b.querySelectorAll("script[custom-element],script[custom-template]");for(var f=0;f<b.length;f++){var h=b[f];h=h.getAttribute("custom-element")||h.getAttribute("custom-template");e[h]=!0}e=Object.keys(e)}else e=[];a=e.includes("amp-geo")?O(a,"extensions").waitForExtension(a,"amp-geo"):Promise.resolve();return a}).then(function(){return R(N(a),
"geo")})};function S(a){a=AMP.BaseElement.call(this,a)||this;a.J=null;a.m=null;var b=new w;a.K=b.promise;a.L=b.resolve;a.l=null;a.F=!1;a.A=null;a.B=null;a.w=null;a.j=null;a.H="";a.I=null;a.T=null;return a}var T=AMP.BaseElement;S.prototype=n(T.prototype);S.prototype.constructor=S;if(v)v(S,T);else for(var V in T)if("prototype"!=V)if(Object.defineProperties){var W=Object.getOwnPropertyDescriptor(T,V);W&&Object.defineProperty(S,V,W)}else S[V]=T[V];S.Y=T.prototype;m=S.prototype;m.isAlwaysFixed=function(){return!0};
m.buildCallback=function(){var a=this,b=this.getAmpDoc();this.T=fa(this.element);this.I=Q(N(this.element),"storage");this.m=E(this.element.id,"amp-user-notification should have an id.");this.H="amp-user-notification:"+this.m;this.A=this.element.getAttribute("data-show-if-geo");this.B=this.element.getAttribute("data-show-if-not-geo");(this.j=this.element.getAttribute("data-show-if-href"))&&J(this.j,this.element);E(1>=!!this.j+!!this.A+!!this.B,'Only one "data-show-if-*" attribute allowed');this.A&&
(this.w=X(this,this.A,!0));this.B&&(this.w=X(this,this.B,!1));(this.l=this.element.getAttribute("data-dismiss-href"))&&J(this.l,this.element);var c=this.element.getAttribute("role");c||this.element.setAttribute("role","alert");var g=this.element.getAttribute("data-persist-dismissal");this.F="false"!=g&&"no"!=g;this.registerDefaultAction(function(){return a.dismiss(!1)},"dismiss");this.registerAction("optoutOfCid",function(){return ja(a)});var d=Q(N(b),"userNotificationManager");d.then(function(b){b.registerUserNotification(a.m,
a)})};function X(a,b,c){return ia(a.element).then(function(a){E(a,"requires <amp-geo> to use promptIfUnknownForGeoGroup");var d=b.split(/,\s*/).filter(function(b){return 2==a.isInCountryGroup(b)});return!(c?!d.length:d.length)})}
function ka(a,b){var c=a.j;return a.T.expandUrlAsync(c).then(function(c){var d={elementId:a.m,ampUserId:b};var e=[];for(l in d){var f=d[l];if(null!=f)if(Array.isArray(f))for(var g=0;g<f.length;g++){var k=f[g];e.push(encodeURIComponent(l)+"="+encodeURIComponent(k))}else e.push(encodeURIComponent(l)+"="+encodeURIComponent(f))}d=e.join("&");e=c;if(d){e=e.split("#",2);var l=e[0].split("?",2);d=l[0]+(l[1]?"?"+l[1]+"&"+d:"?"+d);d+=e[1]?"#"+e[1]:""}else d=e;return d})}
m.V=function(a){var b=this;this.J=a;return ka(this,a).then(function(a){var c={credentials:"include"};return O(b.win,"xhr").fetchJson(a,c).then(function(a){return a.json()})})};function la(a){var b=a.element.getAttribute("enctype")||"application/json;charset=utf-8";O(a.win,"xhr").fetchJson(a.l,{method:"POST",credentials:"include",body:F({elementId:a.m,ampUserId:a.J}),headers:{"Content-Type":b}})}
m.X=function(a){E("boolean"==typeof a.showNotification,'`showNotification` should be a boolean. Got "%s" which is of type %s.',a.showNotification,typeof a.showNotification);a.showNotification||this.L();return Promise.resolve(a.showNotification)};function ja(a){return Q(N(a.element),"cid").then(function(a){return a.optOut()}).then(function(){return a.dismiss(!1)},function(b){D().error("amp-user-notification","Failed to opt out of Cid",b);a.dismiss(!0)})}
function ma(a){return Q(N(a.element),"cid").then(function(b){return b.get({scope:"amp-user-notification",createCookieIfNotPresent:!0},Promise.resolve(),a.K)})}m.shouldShow=function(){var a=this;return this.isDismissed().then(function(b){return b?!1:a.j?ma(a).then(a.V.bind(a)).then(a.X.bind(a)):a.w?a.w:!0})};
m.show=function(){var a=this.element,b=!0;void 0===b&&(b=a.hasAttribute("hidden"));b?a.removeAttribute("hidden"):a.setAttribute("hidden","");this.element.classList.add("amp-active");this.getViewport().addToFixedLayer(this.element);return this.K};m.isDismissed=function(){var a=this;return this.F?this.I.then(function(b){return b.get(a.H)}).then(function(a){return!!a},function(a){D().error("amp-user-notification","Failed to read storage",a);return!1}):Promise.resolve(!1)};
m.dismiss=function(a){var b=this;this.element.classList.remove("amp-active");this.element.classList.add("amp-hidden");this.L();this.getViewport().removeFromFixedLayer(this.element);this.F&&!a&&this.I.then(function(a){a.set(b.H,!0)});this.l&&la(this)};function Y(a){this.ampdoc=a;this.S=Object.create(null);this.D=Object.create(null);this.M=this.ampdoc.whenReady();this.N=Promise.all([this.ampdoc.whenFirstVisible(),this.M]);this.W=Q(N(this.ampdoc),"notificationUIManager")}
Y.prototype.get=function(a){var b=this;this.N.then(function(){null==b.ampdoc.getElementById(a)&&C().warn("amp-user-notification","Did not find amp-user-notification element "+a+".")});return Z(this,a).promise};Y.prototype.getNotification=function(a){var b=this;return this.M.then(function(){return b.S[a]})};
Y.prototype.registerUserNotification=function(a,b){var c=this;this.S[a]=b;var g=Z(this,a);return this.N.then(function(){return b.shouldShow()}).then(function(a){if(a)return c.W.then(function(a){return a.registerUI(b.show.bind(b))})}).then(g.resolve.bind(this,b)).catch(ca.bind(null,"Notification service failed amp-user-notification",a))};function Z(a,b){if(a.D[b])return a.D[b];var c=new w;return a.D[b]={promise:c.promise,resolve:c.resolve}}
(function(a){a.registerServiceForDoc("userNotificationManager",Y);a.registerServiceForDoc("notificationUIManager",x);a.registerElement("amp-user-notification",S,"amp-user-notification{position:fixed!important;bottom:0;left:0;overflow:hidden!important;visibility:hidden;background:hsla(0,0%,100%,0.7);z-index:1000;width:100%}amp-user-notification.amp-active{visibility:visible}amp-user-notification.amp-hidden{visibility:hidden}\n/*# sourceURL=/extensions/amp-user-notification/0.1/amp-user-notification.css*/")})(self.AMP);
})});

//# sourceMappingURL=amp-user-notification-0.1.js.map
