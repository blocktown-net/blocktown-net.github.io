<!--#include virtual="/header-global.html" -->

        <!-- use recent version of videojs to ensure proper functioning with the iOS devices -->
        <link rel="stylesheet" href="/videojs/demo/videojs_5/video-js.css">
        <script type="text/javascript" src="/videojs/demo/videojs_5/video.js"></script>
        <!-- videojs-vast-vpaid -->
  	<link href="/videojs/styles/videojs.vast.vpaid.css" rel="stylesheet">
  	<script src="/videojs/scripts/videojs_5.vast.vpaid.js"></script>

<script src="https://cdn.cookielaw.org/consent/04838ef9-c951-4932-92ea-0c259d42ce0e.js" type="text/javascript" charset="UTF-8"></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!--
<link rel="stylesheet" href="/optanon_4.3.1.css">
<script async src="/optanon_4.3.1_nojquery.js"></script>
-->
<!-- OneTrust Cookies Consent Notice end -->


<!-- GPT / start -->
<script async='async' src='https://www.googletagservices.com/tag/js/gpt.js'></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>
<script>
  googletag.cmd.push(function() {
    googletag.pubads().disableInitialLoad();
    googletag.defineSlot('/21793097377/bt', [[728, 90], [970, 90], [970, 250]], 'div-gpt-ad-1560191267500-0').addService(googletag.pubads());
 //googletag.defineSlot('/21793097377/bt-1', [[300, 250], [300, 600]], 'div-gpt-ad-1548036596348-1').addService(googletag.pubads());
    googletag.pubads().enableSingleRequest();
    googletag.enableServices();
  });
</script>
<!-- GPT / end -->

<!-- prebid start -->
<script async src="/prebid-js/prebid.js"></script>
<script>
var pbjs = pbjs || {};
            pbjs.que = pbjs.que || [];

            var videoAdUnit = {
                code: '/21793097377/el-testo-prebid-video-vast-a',
                mediaTypes: {
                    video: {
                        playerSize: [[640,480]],
                        context: 'instream'
                    }
                },
                bids: [{
                    bidder: 'ix',
                    params: {
                        siteId: '335943',
                        size: [640,480],
                        video: {
                            protocols: [2,3,5,6],
                            mimes: [
                                'video/mp4',
				'video/webm',
				'video/3gpp',
				'video/x-mpegURL',
				'application/javascript',
				'application/x-shockwave-flash'
                            ],
                            minduration: 0,
                            maxduration: 60,
			    linearity:1,
			    api: [1,2],
			    playbackmethod: [3],
			    startdelay: 0
                        }
                    }
                }]
            };

	    var bannerAdUnit = 
{
    code: '/21793097377/bt',
    mediaTypes: {
        banner: {
            sizes: [
                [970, 90],
                [970,250],
                [728, 90]
            ]
        }
    },
    bids: [{
        bidder: 'ix',
        params: {
            siteId: '335943',
            size: [970, 90]
        }
    },{
        bidder: 'ix',
        params: {
            siteId: '335943',
            size: [970,250]
        }
    },{
        bidder: 'ix',
        params: {
            siteId: '335943',
            size: [728, 90]
        }
    }
]
}
             var bannerAdUnit2 =
{
    code: '/21793097377/bt-1',
    mediaTypes: {
        banner: {
            sizes: [
                [300, 600],
                [300, 250]
            ]
        }
    },
    bids: [{
        bidder: 'ix',
        params: {
            siteId: '335943',
            size: [300, 600]
        }
    },{
        bidder: 'ix',
        params: {
            siteId: '335943',
            size: [300, 250]
        }
    }
]
}


pbjs.que.push(function() {
//
// Uncomment this and enjoy Prebid Server!
// 
//   888       888  .d88888b.  888       888 
//   888   o   888 d88P" "Y88b 888   o   888 
//   888  d8b  888 888     888 888  d8b  888 
//   888 d888b 888 888     888 888 d888b 888 
//   888d88888b888 888     888 888d88888b888 
//   88888P Y88888 888     888 88888P Y88888 
//   8888P   Y8888 Y88b. .d88P 8888P   Y8888 
//   888P     Y888  "Y88888P"  888P     Y888 
//                                           
/*
    pbjs.setConfig({
        s2sConfig: {
            accountId: '1',
            enabled: true,
            bidders: ['ix' ],
            timeout: 5000,
            adapter: 'prebidServer',
            endpoint: 'http://s2s.blocktown.net/openrtb2/auction',
            syncEndpoint: 'http://s2s.blocktown.net/cookie_sync'
        }
    });
*/

                pbjs.setConfig({
		    ix: { timeout: 1000},
                    debug: true,
                    cache: {
                        url: 'https://prebid.adnxs.com/pbc/v1/cache'
                    },
                });

pbjs.addAdUnits([videoAdUnit,bannerAdUnit]);
pbjs.requestBids({  timeout:5000,
                    bidsBackHandler: function(bidResponses) {
sendAdserverRequest();                    
}
                });

});

        function sendAdserverRequest(bids) {
          if (pbjs.adserverRequestSent) return;
          pbjs.adserverRequestSent = true;
          googletag.cmd.push(function() {
          pbjs.que.push(function() {
            
	    // NEED to specify only the banner ad codes for GPTAsync, if you set targeting for the video slot it will NOT load
	    pbjs.setTargetingForGPTAsync && pbjs.setTargetingForGPTAsync(['/21793097377/bt']);
	    googletag.display('div-gpt-ad-1560191267500-0');
            //googletag.display('div-gpt-ad-1548036596348-1');
	    googletag.pubads().refresh();
          });
        });

	  var videoUrl = pbjs.adServers.dfp.buildVideoUrl({
              adUnit: videoAdUnit,
              params: {
                  iu: '/21793097377/el-testo-prebid-video-vast-a',
                  //iu: '/19968336/prebid_cache_video_adunit',
                  cust_params: {
                  },
                  output: 'vast'
              }
          });
          invokeVideoPlayer(videoUrl);
        }
</script>

<!-- prebid end -->



    <meta name="google-site-verification" content="bLvXAgf_r6bJw-lRmKIBxHbcIgHQm316knFDloHMShI" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>BLOCKTOWN.net</title>
    <style type="text/css" media="screen">
    body, html {
     padding: 3px 3px 3px 3px;
     background-color: #000;
     font-family: Courier, Courier New, Verdana, sans-serif;
     font-size: 11pt;
     text-align: center;
    }
    h3{font-family: Courier, Courier New;color: #9999ff;}
    </style>
  </head>
  <body>

<!-- Prebid instream video below -->

<h4>Ads below...</h4>

<div class="example-video-container" align=center>

  <video id="vid1" class="video-js" controls width="800" height="480"
  poster="/videojs/loading.mp4" data-setup="{}">
    <source src="/videojs/loading.mp4" type='video/mp4'>
    <p class="vjs-no-js">
      To view this video please enable JavaScript, and consider upgrading to a web browser that
      <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
    </p>
  </video>

    <!--<video id="vid1" class="video-js vjs-default-skin vjs-big-play-centered" controls data-setup='{}' width='640' height='480'>
      <source src="/videojs/loading.mp4" type='video/mp4'>
      <p class="vjs-no-js">
        To view this video please enable JavaScript, and consider upgrading to a web browser that
        <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
      </p>    
    </video>-->
</div>

<script>
    var page_load_time;

    page_load_time = new Date().getTime() - performance.timing.navigationStart;
    console.log(page_load_time + "ms -- Player loading!");

    var vid1 = videojs('vid1');

    page_load_time = new Date().getTime() - performance.timing.navigationStart;
    console.log(page_load_time + "ms -- Player loaded!");

    function invokeVideoPlayer(url) {

        page_load_time = new Date().getTime() - performance.timing.navigationStart;
        console.log(page_load_time + "ms -- Prebid VAST url = " + url);

        /* Access the player instance by calling `videojs()` and passing
           in the player's ID. Add a `ready` listener to make sure the
           player is ready before interacting with it. */

        videojs("vid1").ready(function() {

            page_load_time = new Date().getTime() - performance.timing.navigationStart;
            console.log(page_load_time + "ms -- Player is ready!");

            /* PASS SETTINGS TO VAST PLUGIN

               Pass in a JSON object to the player's `vastClient` (defined
               by the VAST/VPAID plugin we're using). The requires an
               `adTagUrl`, which will be the URL returned by Prebid. You
               can view all the options available for the `vastClient`
               here:

               https://github.com/MailOnline/videojs-vast-vpaid#options */

            var player = this;
            var vastAd = player.vastClient({
                adTagUrl: url,
                playAdAlways: true,
                verbosity: 4,
                vpaidFlashLoaderPath: "https://github.com/MailOnline/videojs-vast-vpaid/blob/RELEASE/bin/VPAIDFlash.swf?raw=true",
                autoplay: true
            });

            page_load_time = new Date().getTime() - performance.timing.navigationStart;
            console.log(page_load_time + "ms -- Prebid VAST tag inserted!");

            player.muted(true);
            player.play();

            page_load_time = new Date().getTime() - performance.timing.navigationStart;
            console.log(page_load_time + "ms -- invokeVideoPlayer complete!");
        });
    }
</script>

<!-- /21793097377/bt -->
<div id='div-gpt-ad-1560191267500-0'>
<script>
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1560191267500-0'); });
</script>
</div>

<!-- 621793097377/bt-1 -->
<div id='div-gpt-ad-1548036596348-1'>
<script>
//googletag.cmd.push(function() { googletag.display('div-gpt-ad-1548036596348-1'); });
</script>
</div>

<!--#set var="PAGE_H3" value="Prebid.js 2" -->
<!--#include virtual="/nav-developer.html" -->

<!--#include virtual="/footer.html" -->
